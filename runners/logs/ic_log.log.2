 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/runners/application_real_time_api.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/runners/application_real_time_api.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 561}], 'data': [{'_id': ObjectId('611429d9c889609c9144704c'), 'Code': 'INPHI', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'PHILIPS BUY BACK', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'NL0000009322', 'Type': 'Common Stock'}, {'_id': ObjectId('6186a03dc2785d1035dc0997'), 'Code': '', 'Country': 'France', 'Exchange': 'NYSE', 'General': {'Type': 'Common Stock', 'Name': 'PanAmSat Holding CORP', 'Exchange': 'NYSE', 'CurrencyCode': 'USD', 'LogoURL': ''}, 'ISIN': 'LU1861136247', 'Type': 'ETF'}, {'_id': ObjectId('6186a076c2785d1035dcc328'), 'Code': 'LQDA', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'iShares $ Corp Bond ETF USD Dist', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032895942', 'Type': 'ETF'}, {'_id': ObjectId('6186a08cc2785d1035dd047b'), 'Code': 'BUNS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor Bund Daily Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0530119774', 'Type': 'ETF'}, {'_id': ObjectId('6186a097c2785d1035dd2282'), 'Code': 'UEFR', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'UBS ETF - Markit iBoxx â‚¬ Liquid Corporates UCITS ETF (EUR) A-dis EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0721553864', 'Type': 'ETF'}, {'_id': ObjectId('6186a11bc2785d1035deb955'), 'Code': 'PHAU', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'WisdomTree Physical Gold EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3770', 'Type': 'ETC'}, {'_id': ObjectId('6186a148c2785d1035df286a'), 'Code': 'EQQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Invesco EQQQ NASDAQ-100 UCITS ETF EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032077012', 'Type': 'ETF'}, {'_id': ObjectId('6186a174c2785d1035dfaf0a'), 'Code': 'VNRT', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Vanguard FTSE North America UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'USD'}, 'ISIN': 'IE00BKX55R35', 'Type': 'ETF'}, {'_id': ObjectId('6186a183c2785d1035dfd99c'), 'Code': 'MWRD', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amundi MSCI World UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU1437016972', 'Type': 'ETF'}, {'_id': ObjectId('6186a18cc2785d1035dfef6b'), 'Code': 'PHAG', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'ETFS Physical Silver ETC EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3333', 'Type': 'ETC'}]} 
Query itx = {'_id': ObjectId('611429d9c889609c9144704c'), 'Code': 'INPHI', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'PHILIPS BUY BACK', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'NL0000009322', 'Type': 'Common Stock'}
Query itx = {'_id': ObjectId('6186a03dc2785d1035dc0997'), 'Code': '', 'Country': 'France', 'Exchange': 'NYSE', 'General': {'Type': 'Common Stock', 'Name': 'PanAmSat Holding CORP', 'Exchange': 'NYSE', 'CurrencyCode': 'USD', 'LogoURL': ''}, 'ISIN': 'LU1861136247', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a076c2785d1035dcc328'), 'Code': 'LQDA', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'iShares $ Corp Bond ETF USD Dist', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032895942', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a08cc2785d1035dd047b'), 'Code': 'BUNS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor Bund Daily Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0530119774', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a097c2785d1035dd2282'), 'Code': 'UEFR', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'UBS ETF - Markit iBoxx â‚¬ Liquid Corporates UCITS ETF (EUR) A-dis EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0721553864', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a11bc2785d1035deb955'), 'Code': 'PHAU', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'WisdomTree Physical Gold EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3770', 'Type': 'ETC'}
Query itx = {'_id': ObjectId('6186a148c2785d1035df286a'), 'Code': 'EQQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Invesco EQQQ NASDAQ-100 UCITS ETF EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032077012', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a174c2785d1035dfaf0a'), 'Code': 'VNRT', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Vanguard FTSE North America UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'USD'}, 'ISIN': 'IE00BKX55R35', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a183c2785d1035dfd99c'), 'Code': 'MWRD', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amundi MSCI World UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU1437016972', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a18cc2785d1035dfef6b'), 'Code': 'PHAG', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'ETFS Physical Silver ETC EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3333', 'Type': 'ETC'}
NumExpr defaulting to 8 threads.
df  result            ISIN   Code  ... EsgScoreNote total_stocks
0  NL0000009322  INPHI  ...          BBB          560
1  LU1861136247         ...          BBB          560
2  IE0032895942   LQDA  ...          BBB          560
3  LU0530119774   BUNS  ...          BBB          560
4  LU0721553864   UEFR  ...          BBB          560
5  JE00B1VS3770   PHAU  ...          BBB          560
6  IE0032077012   EQQQ  ...          BBB          560
7  IE00BKX55R35   VNRT  ...          BBB          560
8  LU1437016972   MWRD  ...          BBB          560
9  JE00B1VS3333   PHAG  ...          BBB          560

[10 rows x 20 columns] 
127.0.0.1 - - [11/Nov/2021 22:37:14] "[37mGET /api/v1/stock_universe HTTP/1.1[0m" 200 -
127.0.0.1 - - [11/Nov/2021 22:37:30] "[33mGET /api/v1/stock_universe/CAC.PA HTTP/1.1[0m" 404 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
127.0.0.1 - - [12/Nov/2021 22:18:03] "[37mGET /api/v1/stock_data/CAC.PA HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:18:16] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [12/Nov/2021 22:18:16] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:18:16] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:18:16] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:18:16] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:18:16] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:18:16] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
dates sent from 2012-04-13 00:00:00 to 2021-11-13 00:00:00
dates Computed from 2012-04-13 00:00:00 to 2021-11-13 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['IWDA.LSE', 'TDT.AS', 'BX4.PA', 'IAEX.AS', 'VUSA.LSE', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1334268000.0]}, {'$lte': ['$$price.converted_date', 1636758000.0]}]}}}}}]: dates from 2012-04-13 00:00:00 to 2021-11-13 00:00:00
127.0.0.1 - - [12/Nov/2021 22:20:05] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [12/Nov/2021 22:20:05] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:20:05] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:20:05] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:20:05] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:20:05] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [12/Nov/2021 22:20:05] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
dates sent from 2012-04-14 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2012-04-14 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['IWDA.LSE', 'TDT.AS', 'BX4.PA', 'IAEX.AS', 'VUSA.LSE', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1334354400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2012-04-14 00:00:00 to 2021-11-14 00:00:00
127.0.0.1 - - [13/Nov/2021 06:39:13] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 06:39:13] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 06:39:13] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 06:39:13] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 06:39:13] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 06:39:13] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 06:39:13] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 2}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
NumExpr defaulting to 8 threads.
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            1
1  FR0000120578  SAN  ...          BBB            1

[2 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
127.0.0.1 - - [13/Nov/2021 06:52:55] "[37mGET /api/v1/stock_prices/CAC.PA,SAN.PA?lastpriceonly=1&candle=1 HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 2}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            1
1  FR0000120578  SAN  ...          BBB            1

[2 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
127.0.0.1 - - [13/Nov/2021 06:52:59] "[37mGET /api/v1/stock_prices/CAC.PA,SAN.PA?lastpriceonly=1&candle=0 HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 2}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            1
1  FR0000120578  SAN  ...          BBB            1

[2 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
127.0.0.1 - - [13/Nov/2021 06:53:05] "[37mGET /api/v1/stock_prices/CAC.PA,SAN.PA?lastpriceonly=0&candle=0 HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 2}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
NumExpr defaulting to 8 threads.
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            1
1  FR0000120578  SAN  ...          BBB            1

[2 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date   open   high  ...   volume    code  converted_date
0    2021-04-27  61.85  61.96  ...    15259  CAC.PA    1.619474e+09
1    2021-04-28  62.07  62.33  ...    42911  CAC.PA    1.619561e+09
2    2021-04-29  62.49  62.63  ...   421296  CAC.PA    1.619647e+09
3    2021-04-30  62.28  62.34  ...    38586  CAC.PA    1.619734e+09
4    2021-05-03  61.99  62.27  ...    23231  CAC.PA    1.619993e+09
..          ...    ...    ...  ...      ...     ...             ...
273  2021-11-01  88.24  88.60  ...  1860698  SAN.PA    1.635721e+09
274  2021-11-02  88.50  89.92  ...  2156554  SAN.PA    1.635808e+09
275  2021-11-03  89.44  90.71  ...  2312650  SAN.PA    1.635894e+09
276  2021-11-04  90.40  91.00  ...  2062897  SAN.PA    1.635980e+09
277  2021-11-05  90.19  90.77  ...  2105657  SAN.PA    1.636067e+09

[278 rows x 9 columns]
127.0.0.1 - - [13/Nov/2021 07:00:22] "[37mGET /api/v1/stock_prices/CAC.PA,SAN.PA?lastpriceonly=0&candle=0 HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 2}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
NumExpr defaulting to 8 threads.
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            1
1  FR0000120578  SAN  ...          BBB            1

[2 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date   open   high  ...   volume    code  converted_date
0    2021-04-27  61.85  61.96  ...    15259  CAC.PA    1.619474e+09
1    2021-04-28  62.07  62.33  ...    42911  CAC.PA    1.619561e+09
2    2021-04-29  62.49  62.63  ...   421296  CAC.PA    1.619647e+09
3    2021-04-30  62.28  62.34  ...    38586  CAC.PA    1.619734e+09
4    2021-05-03  61.99  62.27  ...    23231  CAC.PA    1.619993e+09
..          ...    ...    ...  ...      ...     ...             ...
273  2021-11-01  88.24  88.60  ...  1860698  SAN.PA    1.635721e+09
274  2021-11-02  88.50  89.92  ...  2156554  SAN.PA    1.635808e+09
275  2021-11-03  89.44  90.71  ...  2312650  SAN.PA    1.635894e+09
276  2021-11-04  90.40  91.00  ...  2062897  SAN.PA    1.635980e+09
277  2021-11-05  90.19  90.77  ...  2105657  SAN.PA    1.636067e+09

[278 rows x 9 columns]
127.0.0.1 - - [13/Nov/2021 07:13:51] "[37mGET /api/v1/stock_prices/CAC.PA,SAN.PA?lastpriceonly=0&candle=0 HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/__pycache__/non_convex_opto.cpython-38.pyc', reloading
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/__pycache__/non_convex_opto.cpython-38.pyc', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 2}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
NumExpr defaulting to 8 threads.
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            1
1  FR0000120578  SAN  ...          BBB            1

[2 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date   open   high  ...   volume    code  converted_date
0    2021-04-27  61.85  61.96  ...    15259  CAC.PA    1.619474e+09
1    2021-04-28  62.07  62.33  ...    42911  CAC.PA    1.619561e+09
2    2021-04-29  62.49  62.63  ...   421296  CAC.PA    1.619647e+09
3    2021-04-30  62.28  62.34  ...    38586  CAC.PA    1.619734e+09
4    2021-05-03  61.99  62.27  ...    23231  CAC.PA    1.619993e+09
..          ...    ...    ...  ...      ...     ...             ...
273  2021-11-01  88.24  88.60  ...  1860698  SAN.PA    1.635721e+09
274  2021-11-02  88.50  89.92  ...  2156554  SAN.PA    1.635808e+09
275  2021-11-03  89.44  90.71  ...  2312650  SAN.PA    1.635894e+09
276  2021-11-04  90.40  91.00  ...  2062897  SAN.PA    1.635980e+09
277  2021-11-05  90.19  90.77  ...  2105657  SAN.PA    1.636067e+09

[278 rows x 9 columns]
127.0.0.1 - - [13/Nov/2021 07:45:37] "[37mGET /api/v1/stock_prices/CAC.PA,SAN.PA?lastpriceonly=0&candle=0 HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 to 2021-11-14
dates Computed from 2021-04-27 to 2021-11-14
127.0.0.1 - - [13/Nov/2021 07:53:43] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 07:53:43] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:53:43] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:53:43] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:53:43] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:53:43] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:53:43] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 to 2021-11-14
dates Computed from 2021-04-27 to 2021-11-14
127.0.0.1 - - [13/Nov/2021 07:54:44] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 07:54:44] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:54:44] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:54:44] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:54:44] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:54:44] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:54:44] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
127.0.0.1 - - [13/Nov/2021 07:55:45] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 07:55:45] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:55:45] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:55:45] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:55:45] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:55:45] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:55:45] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 0.9128518104553223 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.27472519874572754 seconds ---
--- end init 0.33189916610717773 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-04-30                 1.7350 2021-04-30  ...        49.999500          0.000000
2021-05-31                 1.5912 2021-05-31  ...        49.918710          0.000835
2021-06-30                 1.5440 2021-06-30  ...        99.366035         -0.001667
2021-07-31                 1.4818 2021-07-30  ...       148.825853          0.002027
2021-08-31                 1.4428 2021-08-31  ...       197.584451         -0.001747
2021-09-30                 1.4990 2021-09-30  ...       245.517782         -0.002942
2021-10-31                 1.3548 2021-10-29  ...       294.282202          0.003498
2021-11-30                 1.2740 2021-11-05  ...       343.317079          0.003139

[8 rows x 38 columns]
--- 0.365494966506958 seconds ---
127.0.0.1 - - [13/Nov/2021 07:58:01] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 07:58:01] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:58:01] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:58:01] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:58:01] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:58:01] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 07:58:01] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 1.138310194015503 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.4560549259185791 seconds ---
--- end init 0.5083599090576172 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-04-30                 1.7350 2021-04-30  ...        49.999500          0.000000
2021-05-31                 1.5912 2021-05-31  ...        49.918710          0.000835
2021-06-30                 1.5440 2021-06-30  ...        99.366035         -0.001667
2021-07-31                 1.4818 2021-07-30  ...       148.825853          0.002027
2021-08-31                 1.4428 2021-08-31  ...       197.584451         -0.001747
2021-09-30                 1.4990 2021-09-30  ...       245.517782         -0.002942
2021-10-31                 1.3548 2021-10-29  ...       294.282202          0.003498
2021-11-30                 1.2740 2021-11-05  ...       343.317079          0.003139

[8 rows x 38 columns]
--- 0.5441007614135742 seconds ---
127.0.0.1 - - [13/Nov/2021 08:01:18] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 08:01:18] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:18] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:18] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:18] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:18] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:18] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 1.0867860317230225 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.3810720443725586 seconds ---
--- end init 0.4327280521392822 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-04-30                 1.7350 2021-04-30  ...        49.999500          0.000000
2021-05-31                 1.5912 2021-05-31  ...        49.918710          0.000835
2021-06-30                 1.5440 2021-06-30  ...        99.366035         -0.001667
2021-07-31                 1.4818 2021-07-30  ...       148.825853          0.002027
2021-08-31                 1.4428 2021-08-31  ...       197.584451         -0.001747
2021-09-30                 1.4990 2021-09-30  ...       245.517782         -0.002942
2021-10-31                 1.3548 2021-10-29  ...       294.282202          0.003498
2021-11-30                 1.2740 2021-11-05  ...       343.317079          0.003139

[8 rows x 38 columns]
--- 0.4636561870574951 seconds ---
127.0.0.1 - - [13/Nov/2021 08:01:22] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 08:01:22] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:22] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:22] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:22] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:22] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:01:22] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 0.9200830459594727 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.5750651359558105 seconds ---
--- end init 0.6616370677947998 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-04-30                 1.7350 2021-04-30  ...        49.999500          0.000000
2021-05-31                 1.5912 2021-05-31  ...        49.918710          0.000835
2021-06-30                 1.5440 2021-06-30  ...        99.366035         -0.001667
2021-07-31                 1.4818 2021-07-30  ...       148.825853          0.002027
2021-08-31                 1.4428 2021-08-31  ...       197.584451         -0.001747
2021-09-30                 1.4990 2021-09-30  ...       245.517782         -0.002942
2021-10-31                 1.3548 2021-10-29  ...       294.282202          0.003498
2021-11-30                 1.2740 2021-11-05  ...       343.317079          0.003139

[8 rows x 38 columns]
--- 0.6997768878936768 seconds ---
127.0.0.1 - - [13/Nov/2021 08:03:59] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 1.9850401878356934 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.5293047428131104 seconds ---
--- end init 0.630544900894165 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-04-30                 1.7350 2021-04-30  ...        49.999500          0.000000
2021-05-31                 1.5912 2021-05-31  ...        49.918710          0.000835
2021-06-30                 1.5440 2021-06-30  ...        99.366035         -0.001667
2021-07-31                 1.4818 2021-07-30  ...       148.825853          0.002027
2021-08-31                 1.4428 2021-08-31  ...       197.584451         -0.001747
2021-09-30                 1.4990 2021-09-30  ...       245.517782         -0.002942
2021-10-31                 1.3548 2021-10-29  ...       294.282202          0.003498
2021-11-30                 1.2740 2021-11-05  ...       343.317079          0.003139

[8 rows x 38 columns]
--- 0.6652038097381592 seconds ---
127.0.0.1 - - [13/Nov/2021 08:04:35] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 0.929495096206665 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.2667200565338135 seconds ---
127.0.0.1 - - [13/Nov/2021 08:07:02] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 08:07:02] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:07:02] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:07:02] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:07:02] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:07:02] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:07:02] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 1.0190658569335938 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.48259997367858887 seconds ---
--- end init 0.5455927848815918 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-05-02                 1.7350 2021-04-30  ...        49.999500          0.000000
2021-05-09                 1.6538 2021-05-07  ...        49.944136         -0.000318
2021-05-16                 1.6422 2021-05-14  ...        49.758803         -0.002453
2021-05-23                 1.6310 2021-05-21  ...        49.900884          0.000731
2021-05-30                 1.5734 2021-05-28  ...        50.028491          0.001903
2021-06-06                 1.5574 2021-06-04  ...        50.472860         -0.000182
2021-06-13                 1.5134 2021-06-11  ...       100.382871          0.000105
2021-06-20                 1.5248 2021-06-18  ...        99.729390         -0.002601
2021-06-27                 1.4926 2021-06-25  ...        99.120470         -0.001341
2021-07-04                 1.5238 2021-07-02  ...        98.454618          0.002133
2021-07-11                 1.5268 2021-07-09  ...        98.560057         -0.000008
2021-07-18                 1.5616 2021-07-16  ...       147.974946          0.001938
2021-07-25                 1.5032 2021-07-23  ...       148.177054          0.000700
2021-08-01                 1.4818 2021-07-30  ...       147.953581         -0.000765
2021-08-08                 1.3914 2021-08-06  ...       147.858807          0.001490
2021-08-15                 1.3606 2021-08-13  ...       147.877889          0.000651
2021-08-22                 1.4678 2021-08-20  ...       198.644130          0.006258
2021-08-29                 1.4426 2021-08-27  ...       197.642555         -0.002846
2021-09-05                 1.4368 2021-09-03  ...       196.050539         -0.002541
2021-09-12                 1.4500 2021-09-10  ...       194.943246         -0.002151
2021-09-19                 1.4884 2021-09-17  ...       193.711764          0.000871
2021-09-26                 1.4506 2021-09-24  ...       241.834358         -0.002885
2021-10-03                 1.4974 2021-10-01  ...       241.981451          0.002031
2021-10-10                 1.4744 2021-10-08  ...       241.592055          0.001087
2021-10-17                 1.3998 2021-10-15  ...       240.854262          0.000386
2021-10-24                 1.3954 2021-10-22  ...       240.445965         -0.000618
2021-10-31                 1.3548 2021-10-29  ...       288.484834         -0.000228
2021-11-07                 1.2740 2021-11-05  ...       287.676219          0.002908

[28 rows x 38 columns]
--- 0.6028339862823486 seconds ---
127.0.0.1 - - [13/Nov/2021 08:07:52] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 1.0881023406982422 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.5538156032562256 seconds ---
--- end init 0.6193227767944336 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-04-27                 1.7336 2021-04-27  ...        49.999500          0.000000
2021-04-28                 1.7146 2021-04-28  ...        50.011351          0.000300
2021-04-29                 1.7188 2021-04-29  ...        50.141878         -0.000125
2021-04-30                 1.7350 2021-04-30  ...        50.237615         -0.000205
2021-05-01                    NaN        NaT  ...              NaN               NaN
...                           ...        ...  ...              ...               ...
2021-11-01                 1.3300 2021-11-01  ...              NaN               NaN
2021-11-02                 1.3174 2021-11-02  ...              NaN               NaN
2021-11-03                 1.3068 2021-11-03  ...              NaN               NaN
2021-11-04                 1.2938 2021-11-04  ...              NaN               NaN
2021-11-05                 1.2740 2021-11-05  ...              NaN               NaN

[193 rows x 38 columns]
--- 0.8251619338989258 seconds ---
127.0.0.1 - - [13/Nov/2021 08:08:18] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 1.0595393180847168 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.47916102409362793 seconds ---
--- end init 0.544644832611084 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-04-27                 1.7336 2021-04-27  ...        49.999500          0.000000
2021-04-28                 1.7146 2021-04-28  ...        50.011351          0.000300
2021-04-29                 1.7188 2021-04-29  ...        50.141878         -0.000125
2021-04-30                 1.7350 2021-04-30  ...        50.237615         -0.000205
2021-05-01                    NaN        NaT  ...              NaN               NaN
...                           ...        ...  ...              ...               ...
2021-11-01                 1.3300 2021-11-01  ...              NaN               NaN
2021-11-02                 1.3174 2021-11-02  ...              NaN               NaN
2021-11-03                 1.3068 2021-11-03  ...              NaN               NaN
2021-11-04                 1.2938 2021-11-04  ...              NaN               NaN
2021-11-05                 1.2740 2021-11-05  ...              NaN               NaN

[193 rows x 38 columns]
--- 0.7379870414733887 seconds ---
127.0.0.1 - - [13/Nov/2021 08:10:02] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 1.0115399360656738 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.5022599697113037 seconds ---
--- end init 0.5663120746612549 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-04-27                 1.7336 2021-04-27  ...        49.999500          0.000000
2021-04-28                 1.7146 2021-04-28  ...        50.011351          0.000300
2021-04-29                 1.7188 2021-04-29  ...        50.141878         -0.000125
2021-04-30                 1.7350 2021-04-30  ...        50.237615         -0.000205
2021-05-01                    NaN        NaT  ...              NaN               NaN
...                           ...        ...  ...              ...               ...
2021-11-01                 1.3300 2021-11-01  ...              NaN               NaN
2021-11-02                 1.3174 2021-11-02  ...              NaN               NaN
2021-11-03                 1.3068 2021-11-03  ...              NaN               NaN
2021-11-04                 1.2938 2021-11-04  ...              NaN               NaN
2021-11-05                 1.2740 2021-11-05  ...              NaN               NaN

[193 rows x 38 columns]
--- 0.7533261775970459 seconds ---
127.0.0.1 - - [13/Nov/2021 08:11:10] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 0.9406180381774902 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.6106891632080078 seconds ---
--- end init 0.7002582550048828 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-04-27                 1.7336 2021-04-27  ...        49.999500          0.000000
2021-04-28                 1.7146 2021-04-28  ...        50.011351          0.000300
2021-04-29                 1.7188 2021-04-29  ...        50.141878         -0.000125
2021-04-30                 1.7350 2021-04-30  ...        50.237615         -0.000205
2021-05-01                    NaN        NaT  ...              NaN               NaN
...                           ...        ...  ...              ...               ...
2021-11-01                 1.3300 2021-11-01  ...              NaN               NaN
2021-11-02                 1.3174 2021-11-02  ...              NaN               NaN
2021-11-03                 1.3068 2021-11-03  ...              NaN               NaN
2021-11-04                 1.2938 2021-11-04  ...              NaN               NaN
2021-11-05                 1.2740 2021-11-05  ...              NaN               NaN

[193 rows x 38 columns]
--- 0.8931910991668701 seconds ---
127.0.0.1 - - [13/Nov/2021 08:11:32] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 6}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            5
1  FR0000120578   SAN  ...          BBB            5
2  FR0007052782   CAC  ...          BBB            5
3  FR0013346681  OBLI  ...          BBB            5
4  IE00BKWQ0G16   STZ  ...          BBB            5
5  FR0010342592   LQQ  ...          BBB            5

[6 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA
BX4.PA   0.071251 -0.000744 -0.046688 -0.036749 -0.035772 -0.014192
OBLI.PA -0.000744  0.001107  0.001840 -0.000955  0.000239  0.000640
LQQ.PA  -0.046688  0.001840  0.085409  0.022117  0.023811  0.009105
STZ.PA  -0.036749 -0.000955  0.022117  0.027707  0.018931  0.005820
CAC.PA  -0.035772  0.000239  0.023811  0.018931  0.019121  0.006685
SAN.PA  -0.014192  0.000640  0.009105  0.005820  0.006685  0.022572
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA   SAN.PA
2021-04-27  1.7336   10.842   655.4   55.19  60.8151  82.2534
2021-04-28  1.7146   10.826   650.5   55.77  61.1296  84.2472
2021-04-29  1.7188   10.792   648.4   56.03  61.1198  83.6404
2021-04-30  1.7350   10.786   650.7   55.86  60.7463  84.0545
2021-05-03  1.7154   10.792   642.1   56.14  61.1100  83.4959
...            ...      ...     ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700  88.3000
2021-11-02  1.3174   10.826   882.3   63.04  68.2100  89.6100
2021-11-03  1.3068   10.834   887.9   63.17  68.4500  90.2400
2021-11-04  1.2938   10.876   925.2   62.52  68.7800  89.6900
2021-11-05  1.2740   10.922   938.3   62.93  69.3100  88.4600

[139 rows x 6 columns]
expected_returns [-0.41817932  0.01455338  1.14692491  0.30828684  0.29031185  0.14822153]
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.43335106803055
w=[0.16666668 0.16666667 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433355984307845
w=[0.16666667 0.16666668 0.16666667 0.16666667 0.16666667 0.16666667]
obj_value=-46.433351069408694
w=[0.16666667 0.16666667 0.16666668 0.16666667 0.16666667 0.16666667]
obj_value=-46.43334636196783
w=[0.16666667 0.16666667 0.16666667 0.16666668 0.16666667 0.16666667]
obj_value=-46.43334946585318
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666668 0.16666667]
obj_value=-46.43334959070002
w=[0.16666667 0.16666667 0.16666667 0.16666667 0.16666667 0.16666668]
obj_value=-46.433349784481216
w=[9.99999991e-01 0.00000000e+00 6.09079026e-09 1.37648126e-09
 1.18741994e-09 8.92885765e-10]
obj_value=-3.7463295452602385
w=[0.5408887  0.09182226 0.09182226 0.09182226 0.09182226 0.09182226]
obj_value=-20.92878635580864
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125849080727
w=[0.32924391 0.13415122 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125152704742
w=[0.3292439  0.13415124 0.13415122 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125852413885
w=[0.3292439  0.13415122 0.13415124 0.13415122 0.13415122 0.13415122]
obj_value=-103.79125464381268
w=[0.3292439  0.13415122 0.13415122 0.13415124 0.13415122 0.13415122]
obj_value=-103.79126353344603
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415124 0.13415122]
obj_value=-103.79126385167301
w=[0.3292439  0.13415122 0.13415122 0.13415122 0.13415122 0.13415124]
obj_value=-103.79125746308361
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72189866217366
w=[3.84814011e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7218614927882
w=[3.84813996e-01 1.49011612e-08 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72190031816828
w=[3.84813996e-01 0.00000000e+00 2.03185568e-08 0.00000000e+00
 6.15185999e-01 1.30681538e-09]
obj_value=-220.7219294355354
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 1.49011612e-08
 6.15185999e-01 1.30681538e-09]
obj_value=-220.72192087222
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15186014e-01 1.30681538e-09]
obj_value=-220.7219165661703
w=[3.84813996e-01 0.00000000e+00 5.41739564e-09 0.00000000e+00
 6.15185999e-01 1.62079766e-08]
obj_value=-220.7219117212818
w=[0.24335099 0.         0.         0.         0.75664914 0.        ]
obj_value=-85.07993007641804
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391798622954
w=[3.28652739e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391989089929
w=[3.28652724e-01 1.49011612e-08 3.26667200e-09 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391824098968
w=[3.28652724e-01 0.00000000e+00 1.81678332e-08 0.00000000e+00
 6.71347325e-01 7.88005434e-10]
obj_value=-341.5391757532829
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 1.49011612e-08
 6.71347325e-01 7.88005434e-10]
obj_value=-341.53917239503346
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347339e-01 7.88005434e-10]
obj_value=-341.5391629573594
w=[3.28652724e-01 0.00000000e+00 3.26667200e-09 0.00000000e+00
 6.71347325e-01 1.56891666e-08]
obj_value=-341.53918748941953
w=[2.41513932e-02 0.00000000e+00 3.53442515e-08 0.00000000e+00
 5.40064390e-06 9.75848421e-01]
obj_value=-7.334855562356588
w=[2.18590455e-01 0.00000000e+00 1.48611409e-08 0.00000000e+00
 4.28690205e-01 3.52721256e-01]
obj_value=-59.74596536608329
w=[2.99599867e-01 0.00000000e+00 6.32723438e-09 0.00000000e+00
 6.07293744e-01 9.31069311e-02]
obj_value=-301.3908897519344
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604648394507
w=[3.18854957e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66049305395285
w=[3.18854942e-01 1.49011612e-08 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66046710925406
w=[3.18854942e-01 0.00000000e+00 1.91999769e-08 0.00000000e+00
 6.49745903e-01 3.13993704e-02]
obj_value=-355.66045520097725
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 1.49011612e-08
 6.49745903e-01 3.13993704e-02]
obj_value=-355.6604536902379
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745918e-01 3.13993704e-02]
obj_value=-355.6604431572319
w=[3.18854942e-01 0.00000000e+00 4.29881568e-09 0.00000000e+00
 6.49745903e-01 3.13993853e-02]
obj_value=-355.6604582100579
w=[4.07558797e-01 4.90098775e-07 5.01929187e-01 6.27447994e-07
 0.00000000e+00 9.05118670e-02]
obj_value=-18.927688594393825
w=[3.49619359e-01 1.69976864e-07 1.74079910e-01 2.17612546e-07
 4.24399960e-01 5.19008638e-02]
obj_value=-107.16187753705387
w=[3.26784841e-01 4.38135799e-08 4.48711925e-02 5.60922496e-08
 5.91660277e-01 3.66838768e-02]
obj_value=-343.04301198854245
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586999029359
w=[3.22200567e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1587251232327
w=[3.22200552e-01 3.33860342e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.15870165295433
w=[3.22200552e-01 1.84848730e-08 1.89310953e-02 2.36652223e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586692749749
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 3.85663835e-08
 6.25239679e-01 3.36288944e-02]
obj_value=-370.1586913060794
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239694e-01 3.36288944e-02]
obj_value=-370.15867941448994
w=[3.22200552e-01 1.84848730e-08 1.89310804e-02 2.36652223e-08
 6.25239679e-01 3.36289093e-02]
obj_value=-370.1586924158286
w=[6.61927269e-01 1.30124926e-06 1.15132082e-07 1.69137184e-06
 0.00000000e+00 3.38072114e-01]
obj_value=-8.288159802597914
w=[4.55529337e-01 5.21917214e-07 1.15014539e-02 6.78171580e-07
 3.79858781e-01 1.53110355e-01]
obj_value=-47.13199693309657
w=[3.63268724e-01 1.73553005e-07 1.66425935e-02 2.25267444e-07
 5.49657015e-01 7.04317883e-02]
obj_value=-264.0275093735188
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.80875658170476
w=[3.34534804e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087453767497
w=[3.34534789e-01 7.99585233e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087586737291
w=[3.34534789e-01 6.50573621e-08 1.82437811e-02 8.42135578e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087487095439
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 9.91147190e-08
 6.02539510e-01 4.46821157e-02]
obj_value=-390.8087673439772
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539525e-01 4.46821157e-02]
obj_value=-390.80875385652433
w=[3.34534789e-01 6.50573621e-08 1.82437662e-02 8.42135578e-08
 6.02539510e-01 4.46821306e-02]
obj_value=-390.80875010443333
w=[3.28103352e-01 6.42061772e-07 5.06958166e-08 5.81028523e-01
 0.00000000e+00 9.08687718e-02]
obj_value=-66.70623845422602
w=[3.32547615e-01 2.43339105e-07 1.26068571e-02 1.79525164e-01
 4.16367980e-01 5.89527822e-02]
obj_value=-323.99255855266296
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654085512645
w=[3.33831381e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465275938523
w=[3.33831366e-01 1.43066968e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.24654531333374
w=[3.33831366e-01 1.28165807e-07 1.62484193e-02 6.35486476e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465383365334
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486625e-02
 5.36638226e-01 4.97336681e-02]
obj_value=-419.2465379800735
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638241e-01 4.97336681e-02]
obj_value=-419.24653869101655
w=[3.33831366e-01 1.28165807e-07 1.62484044e-02 6.35486476e-02
 5.36638226e-01 4.97336830e-02]
obj_value=-419.24653210317666
w=[8.97439784e-02 7.59992965e-01 0.00000000e+00 1.50262800e-01
 2.66692769e-07 1.20788494e-09]
obj_value=-140.66001082485298
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160917182303
w=[0.253436   0.25031994 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160675720134
w=[0.25343599 0.25031996 0.01089665 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160856484672
w=[0.25343599 0.25031994 0.01089666 0.0921098  0.35988509 0.03335283]
obj_value=-556.3160789754363
w=[0.25343599 0.25031994 0.01089665 0.09210981 0.35988509 0.03335283]
obj_value=-556.3160856689376
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988511 0.03335283]
obj_value=-556.316093117244
w=[0.25343599 0.25031994 0.01089665 0.0921098  0.35988509 0.03335284]
obj_value=-556.3160779773442
w=[1.91523888e-01 3.85966267e-01 1.22455771e-10 5.66267866e-11
 4.22509844e-01 8.17981169e-11]
obj_value=-330.19096471283507
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.563526438129
w=[0.24222354 0.27488589 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635289001531
w=[0.24222353 0.27488591 0.00892323 0.07542844 0.37122662 0.02731253]
obj_value=-565.5635168394884
w=[0.24222353 0.27488589 0.00892325 0.07542844 0.37122662 0.02731253]
obj_value=-565.5634962842352
w=[0.24222353 0.27488589 0.00892323 0.07542846 0.37122662 0.02731253]
obj_value=-565.563515702558
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122664 0.02731253]
obj_value=-565.5635132307353
w=[0.24222353 0.27488589 0.00892323 0.07542844 0.37122662 0.02731255]
obj_value=-565.5635116602341
w=[0.25141205 0.27285732 0.         0.0894487  0.38628193 0.        ]
obj_value=-535.1289924747424
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241992856902
w=[0.24427361 0.27443329 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241956518582
w=[0.2442736  0.27443331 0.00693235 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241903730222
w=[0.2442736  0.27443329 0.00693236 0.07855654 0.37458565 0.02121877]
obj_value=-568.2241802914074
w=[0.2442736  0.27443329 0.00693235 0.07855655 0.37458565 0.02121877]
obj_value=-568.2241886806165
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458566 0.02121877]
obj_value=-568.2241884586826
w=[0.2442736  0.27443329 0.00693235 0.07855654 0.37458565 0.02121878]
obj_value=-568.2241939499611
w=[3.08489744e-01 9.30915116e-02 2.51159076e-12 7.05345993e-02
 4.64289820e-01 6.35943256e-02]
obj_value=-429.5232279770569
w=[0.25069521 0.25629912 0.00623911 0.07775434 0.38355606 0.02545632]
obj_value=-568.4776965740791
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.963958936339
w=[0.24781715 0.2644266  0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639497680903
w=[0.24781714 0.26442661 0.00654981 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639508353928
w=[0.24781714 0.2644266  0.00654983 0.07811387 0.37953565 0.02355711]
obj_value=-568.9639458255937
w=[0.24781714 0.2644266  0.00654981 0.07811389 0.37953565 0.02355711]
obj_value=-568.9639506507142
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953566 0.02355711]
obj_value=-568.9639505841747
w=[0.24781714 0.2644266  0.00654981 0.07811387 0.37953565 0.02355712]
obj_value=-568.9639521000439
w=[2.37506192e-01 2.87829035e-01 2.73995496e-12 8.11890305e-02
 3.65376119e-01 2.80996241e-02]
obj_value=-564.4202412710298
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.35749177576
w=[0.24556415 0.26954016 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574842278006
w=[0.24556414 0.26954018 0.00511864 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574833417131
w=[0.24556414 0.26954016 0.00511866 0.07878581 0.37644171 0.02454967]
obj_value=-569.3574823714773
w=[0.24556414 0.26954016 0.00511864 0.07878583 0.37644171 0.02454967]
obj_value=-569.357482608173
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644173 0.02454967]
obj_value=-569.3574828184998
w=[0.24556414 0.26954016 0.00511864 0.07878581 0.37644171 0.02454969]
obj_value=-569.3574830188323
w=[0.24610453 0.26907775 0.0044456  0.07691659 0.37974948 0.02370605]
obj_value=-569.2450065184668
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642348343279
w=[0.24566809 0.26945123 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642268672174
w=[0.24566807 0.26945124 0.00498919 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642264009754
w=[0.24566807 0.26945123 0.00498921 0.0784263  0.37707791 0.02438742]
obj_value=-569.3642261194806
w=[0.24566807 0.26945123 0.00498919 0.07842631 0.37707791 0.02438742]
obj_value=-569.3642260299339
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707792 0.02438742]
obj_value=-569.3642260460759
w=[0.24566807 0.26945123 0.00498919 0.0784263  0.37707791 0.02438743]
obj_value=-569.3642263574668
w=[0.23397821 0.31770151 0.0082876  0.07410712 0.33822207 0.02770349]
obj_value=-546.5637995563353
w=[0.24449909 0.27427625 0.00531903 0.07799438 0.37319233 0.02471902]
obj_value=-569.1896789892905
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368032085926
w=[0.24551943 0.2700648  0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.3680237079865
w=[0.24551942 0.27006482 0.00503114 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023592652
w=[0.24551942 0.2700648  0.00503115 0.07837137 0.3765838  0.02442959]
obj_value=-569.368023429162
w=[0.24551942 0.2700648  0.00503114 0.07837139 0.3765838  0.02442959]
obj_value=-569.3680235986387
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.37658381 0.02442959]
obj_value=-569.3680235425043
w=[0.24551942 0.2700648  0.00503114 0.07837137 0.3765838  0.0244296 ]
obj_value=-569.3680235900935
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683939873064
w=[0.24553014 0.27008817 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683854605621
w=[0.24553013 0.27008818 0.00500253 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855065983
w=[0.24553013 0.27008817 0.00500255 0.07850138 0.37644477 0.02443303]
obj_value=-569.3683855508764
w=[0.24553013 0.27008817 0.00500253 0.07850139 0.37644477 0.02443303]
obj_value=-569.3683855037883
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644479 0.02443303]
obj_value=-569.3683855260334
w=[0.24553013 0.27008817 0.00500253 0.07850138 0.37644477 0.02443304]
obj_value=-569.368385524223
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684405257682
w=[0.24552476 0.27008133 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320418271
w=[0.24552475 0.27008134 0.0050064  0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320414714
w=[0.24552475 0.27008133 0.00500642 0.07846407 0.37648212 0.02444134]
obj_value=-569.3684320420189
w=[0.24552475 0.27008133 0.0050064  0.07846408 0.37648212 0.02444134]
obj_value=-569.3684320414642
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648213 0.02444134]
obj_value=-569.3684320413632
w=[0.24552475 0.27008133 0.0050064  0.07846407 0.37648212 0.02444135]
obj_value=-569.368432040818
_make_output_weights = OrderedDict([('BX4.PA', 0.24552474657212184), ('OBLI.PA', 0.2700813300052892), ('LQQ.PA', 0.005006401592221771), ('STZ.PA', 0.07846406610149567), ('CAC.PA', 0.3764821169666443), ('SAN.PA', 0.024441338762227212)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.24552), ('OBLI.PA', 0.27008), ('LQQ.PA', 0.00501), ('STZ.PA', 0.07846), ('CAC.PA', 0.37648), ('SAN.PA', 0.02444)]), 'expected_return': 0.04410858385753515, 'volatility': 0.015946072643852546, 'sharpe_ratio': 1.5118822293105112}
--- 0.8995001316070557 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date     open     high  ...   volume    code  converted_date
0    2021-04-27   1.7336   1.7436  ...  2270741  BX4.PA    1.619474e+09
1    2021-04-28   1.7220   1.7282  ...  4411200  BX4.PA    1.619561e+09
2    2021-04-29   1.6996   1.7252  ...  4494761  BX4.PA    1.619647e+09
3    2021-04-30   1.7108   1.7354  ...  4020190  BX4.PA    1.619734e+09
4    2021-05-03   1.7274   1.7444  ...  4487623  BX4.PA    1.619993e+09
..          ...      ...      ...  ...      ...     ...             ...
829  2021-11-01  62.5400  63.2700  ...     4444  STZ.PA    1.635721e+09
830  2021-11-02  62.9300  63.0400  ...     3303  STZ.PA    1.635808e+09
831  2021-11-03  62.8500  63.2600  ...   297542  STZ.PA    1.635894e+09
832  2021-11-04  63.7400  63.7400  ...     6536  STZ.PA    1.635980e+09
833  2021-11-05  62.4400  63.2400  ...     5383  STZ.PA    1.636067e+09

[834 rows x 9 columns]
Getting data --- 0.30640196800231934 seconds ---
--- end init 0.35637712478637695 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'portfolio_value',
       'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-05-02                 1.7350 2021-04-30  ...      9999.900000          0.000000
2021-05-09                 1.6538 2021-05-07  ...      9988.827104         -0.000318
2021-05-16                 1.6422 2021-05-14  ...      9966.328071         -0.002463
2021-05-23                 1.6310 2021-05-21  ...      9977.716081          0.000723
2021-05-30                 1.5734 2021-05-28  ...      9999.397316          0.001923
2021-06-06                 1.5574 2021-06-04  ...     10003.084320         -0.000192
2021-06-13                 1.5134 2021-06-11  ...     10003.942881          0.000166
2021-06-20                 1.5248 2021-06-18  ...      9985.071646         -0.002506
2021-06-27                 1.4926 2021-06-25  ...      9958.811434         -0.001238
2021-07-04                 1.5238 2021-07-02  ...      9988.242428          0.002155
2021-07-11                 1.5268 2021-07-09  ...      9994.022055          0.000048
2021-07-18                 1.5616 2021-07-16  ...     10025.847523          0.001968
2021-07-25                 1.5032 2021-07-23  ...     10034.706652          0.000860
2021-08-01                 1.4818 2021-07-30  ...     10033.212834         -0.000832
2021-08-08                 1.3914 2021-08-06  ...     10045.707409          0.001638
2021-08-15                 1.3606 2021-08-13  ...     10057.194017          0.000601
2021-08-22                 1.4678 2021-08-20  ...     10105.870283          0.006234
2021-08-29                 1.4426 2021-08-27  ...     10084.119012         -0.002689
2021-09-05                 1.4368 2021-09-03  ...     10070.251621         -0.002434
2021-09-12                 1.4500 2021-09-10  ...     10056.695155         -0.002195
2021-09-19                 1.4884 2021-09-17  ...     10061.349650          0.000778
2021-09-26                 1.4506 2021-09-24  ...     10025.778844         -0.002844
2021-10-03                 1.4974 2021-10-01  ...     10036.552258          0.001811
2021-10-10                 1.4744 2021-10-08  ...     10054.364460          0.001132
2021-10-17                 1.3998 2021-10-15  ...     10058.096665          0.000522
2021-10-24                 1.3954 2021-10-22  ...     10068.787689         -0.000530
2021-10-31                 1.3548 2021-10-29  ...     10076.749037          0.000081
2021-11-07                 1.2740 2021-11-05  ...     10094.798725          0.003322

[28 rows x 38 columns]
--- 0.4136362075805664 seconds ---
127.0.0.1 - - [13/Nov/2021 08:14:02] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 8}], 'data': [{'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0010411884   BX4  ...          BBB            7
1  FR0000120578   SAN  ...          BBB            7
2  FR0007052782   CAC  ...          BBB            7
3  FR0013346681  OBLI  ...          BBB            7
4  CH0454664001  ABTC  ...          BBB            7
5  IE00BKWQ0G16   STZ  ...          BBB            7
6  FR0010342592   LQQ  ...          BBB            7
7  CH0454664027  AETH  ...          BBB            7

[8 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned             date    open    high  ...  volume     code  converted_date
0     2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1     2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2     2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3     2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4     2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
...          ...     ...     ...  ...     ...      ...             ...
1057  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
1058  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
1059  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
1060  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
1061  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[1062 rows x 9 columns]
 max_diversification cov =            BX4.PA   OBLI.PA    LQQ.PA  ...    SAN.PA   AETH.PA   ABTC.PA
BX4.PA   0.072079 -0.000725 -0.042919  ... -0.013518 -0.054623 -0.032215
OBLI.PA -0.000725  0.001150  0.001848  ...  0.000580  0.002834 -0.000208
LQQ.PA  -0.042919  0.001848  0.069338  ...  0.007925  0.056865  0.039021
STZ.PA  -0.036656 -0.001038  0.020843  ...  0.005417  0.041665  0.032170
CAC.PA  -0.036025  0.000193  0.021603  ...  0.006178  0.028898  0.015571
SAN.PA  -0.013518  0.000580  0.007925  ...  0.021353  0.018108  0.018430
AETH.PA -0.054623  0.002834  0.056865  ...  0.018108  0.735727  0.519757
ABTC.PA -0.032215 -0.000208  0.039021  ...  0.018430  0.519757  0.548408

[8 rows x 8 columns]
 df_full  =             BX4.PA  OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01  1.5702   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02  1.5550   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03  1.5610   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04  1.5574   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07  1.5410   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...            ...      ...     ...     ...      ...     ...      ...      ...
2021-11-01  1.3300   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02  1.3174   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03  1.3068   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04  1.2938   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05  1.2740   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 8 columns]
expected_returns [-0.37489894  0.0242186   1.65206843  0.24359132  0.24348092  0.09522748
  5.38559083  3.90701991]
w=[0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
obj_value=-7.550369558176519
w=[0.12500001 0.125      0.125      0.125      0.125      0.125
 0.125      0.125     ]
obj_value=-7.550369744339333
w=[0.125      0.12500001 0.125      0.125      0.125      0.125
 0.125      0.125     ]
obj_value=-7.55036956682735
w=[0.125      0.125      0.12500001 0.125      0.125      0.125
 0.125      0.125     ]
obj_value=-7.550369535445446
w=[0.125      0.125      0.125      0.12500001 0.125      0.125
 0.125      0.125     ]
obj_value=-7.550369544878718
w=[0.125      0.125      0.125      0.125      0.12500001 0.125
 0.125      0.125     ]
obj_value=-7.5503695575508125
w=[0.125      0.125      0.125      0.125      0.125      0.12500001
 0.125      0.125     ]
obj_value=-7.5503695665747115
w=[0.125      0.125      0.125      0.125      0.125      0.125
 0.12500001 0.125     ]
obj_value=-7.550368977413975
w=[0.125      0.125      0.125      0.125      0.125      0.125
 0.125      0.12500001]
obj_value=-7.550369072307669
w=[1.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 7.14667214e-12 5.68650682e-12]
obj_value=-3.724727462158092
w=[0.49237954 0.07251721 0.07251721 0.07251721 0.07251721 0.07251721
 0.07251721 0.07251721]
obj_value=-16.36593206818084
w=[0.49237955 0.07251721 0.07251721 0.07251721 0.07251721 0.07251721
 0.07251721 0.07251721]
obj_value=-16.365931762791902
w=[0.49237954 0.07251722 0.07251721 0.07251721 0.07251721 0.07251721
 0.07251721 0.07251721]
obj_value=-16.365932094675372
w=[0.49237954 0.07251721 0.07251722 0.07251721 0.07251721 0.07251721
 0.07251721 0.07251721]
obj_value=-16.365932421948216
w=[0.49237954 0.07251721 0.07251721 0.07251722 0.07251721 0.07251721
 0.07251721 0.07251721]
obj_value=-16.365932400094355
w=[0.49237954 0.07251721 0.07251721 0.07251721 0.07251722 0.07251721
 0.07251721 0.07251721]
obj_value=-16.365932436492255
w=[0.49237954 0.07251721 0.07251721 0.07251721 0.07251721 0.07251722
 0.07251721 0.07251721]
obj_value=-16.365932212357407
w=[0.49237954 0.07251721 0.07251721 0.07251721 0.07251721 0.07251721
 0.07251722 0.07251721]
obj_value=-16.365930783225828
w=[0.49237954 0.07251721 0.07251721 0.07251721 0.07251721 0.07251721
 0.07251721 0.07251722]
obj_value=-16.365930839066394
w=[5.73787641e-01 6.91714741e-11 2.38557507e-11 2.65184541e-11
 4.26212358e-01 5.21474391e-11 2.85511559e-10 2.72742662e-10]
obj_value=-22.151381550334907
w=[5.73787656e-01 6.91714741e-11 2.38557507e-11 2.65184541e-11
 4.26212358e-01 5.21474391e-11 2.85511559e-10 2.72742662e-10]
obj_value=-22.151380183666756
w=[5.73787641e-01 1.49703327e-08 2.38557507e-11 2.65184541e-11
 4.26212358e-01 5.21474391e-11 2.85511559e-10 2.72742662e-10]
obj_value=-22.15138162565515
w=[5.73787641e-01 6.91714741e-11 1.49250169e-08 2.65184541e-11
 4.26212358e-01 5.21474391e-11 2.85511559e-10 2.72742662e-10]
obj_value=-22.15138301420641
w=[5.73787641e-01 6.91714741e-11 2.38557507e-11 1.49276796e-08
 4.26212358e-01 5.21474391e-11 2.85511559e-10 2.72742662e-10]
obj_value=-22.151382699079775
w=[5.73787641e-01 6.91714741e-11 2.38557507e-11 2.65184541e-11
 4.26212373e-01 5.21474391e-11 2.85511559e-10 2.72742662e-10]
obj_value=-22.151382615756965
w=[5.73787641e-01 6.91714741e-11 2.38557507e-11 2.65184541e-11
 4.26212358e-01 1.49533086e-08 2.85511559e-10 2.72742662e-10]
obj_value=-22.151382127440165
w=[5.73787641e-01 6.91714741e-11 2.38557507e-11 2.65184541e-11
 4.26212358e-01 5.21474391e-11 1.51866728e-08 2.72742662e-10]
obj_value=-22.151384180756335
w=[5.73787641e-01 6.91714741e-11 2.38557507e-11 2.65184541e-11
 4.26212358e-01 5.21474391e-11 2.85511559e-10 1.51739039e-08]
obj_value=-22.151383507681043
w=[0.16008148 0.         0.         0.         0.83991852 0.
 0.         0.        ]
obj_value=-27.380940916944795
w=[3.49569153e-01 3.16822493e-11 1.09265250e-11 1.21461091e-11
 6.50430848e-01 2.38848194e-11 1.30771369e-10 1.24922898e-10]
obj_value=-292.2837633293077
w=[3.49569168e-01 3.16822493e-11 1.09265250e-11 1.21461091e-11
 6.50430848e-01 2.38848194e-11 1.30771369e-10 1.24922898e-10]
obj_value=-292.2837453020506
w=[3.49569153e-01 1.49328434e-08 1.09265250e-11 1.21461091e-11
 6.50430848e-01 2.38848194e-11 1.30771369e-10 1.24922898e-10]
obj_value=-292.2837658982524
w=[3.49569153e-01 3.16822493e-11 1.49120877e-08 1.21461091e-11
 6.50430848e-01 2.38848194e-11 1.30771369e-10 1.24922898e-10]
obj_value=-292.2837826895779
w=[3.49569153e-01 3.16822493e-11 1.09265250e-11 1.49133073e-08
 6.50430848e-01 2.38848194e-11 1.30771369e-10 1.24922898e-10]
obj_value=-292.28377421706836
w=[3.49569153e-01 3.16822493e-11 1.09265250e-11 1.21461091e-11
 6.50430863e-01 2.38848194e-11 1.30771369e-10 1.24922898e-10]
obj_value=-292.2837663217891
w=[3.49569153e-01 3.16822493e-11 1.09265250e-11 1.21461091e-11
 6.50430848e-01 1.49250460e-08 1.30771369e-10 1.24922898e-10]
obj_value=-292.28377654143014
w=[3.49569153e-01 3.16822493e-11 1.09265250e-11 1.21461091e-11
 6.50430848e-01 2.38848194e-11 1.50319326e-08 1.24922898e-10]
obj_value=-292.2837877032168
w=[3.49569153e-01 3.16822493e-11 1.09265250e-11 1.21461091e-11
 6.50430848e-01 2.38848194e-11 1.30771369e-10 1.50260841e-08]
obj_value=-292.28379647024417
w=[0.00850296 0.         0.         0.         0.         0.
 0.         0.99941483]
obj_value=-1.3566563285697173
w=[1.97365126e-01 1.75437449e-11 6.05045953e-12 6.72579267e-12
 3.60169909e-01 1.32259921e-11 7.24134047e-11 4.45998353e-01]
obj_value=-3.990347298526477
w=[2.89275675e-01 2.60814802e-11 8.99494046e-12 9.99892724e-12
 5.35448072e-01 1.96624753e-11 1.07653685e-10 1.76675956e-01]
obj_value=-16.454165664210446
w=[3.31042543e-01 2.99612794e-11 1.03329996e-11 1.14863363e-11
 6.15099646e-01 2.25874034e-11 1.23667909e-10 5.42879032e-02]
obj_value=-104.03656012141793
w=[3.45689827e-01 3.13218917e-11 1.08022454e-11 1.20079579e-11
 6.43032772e-01 2.36131507e-11 1.29283961e-10 1.13674600e-02]
obj_value=-288.02073483975687
w=[3.47888205e-01 3.15261030e-11 1.08726735e-11 1.20862469e-11
 6.47225193e-01 2.37671029e-11 1.30126861e-10 4.92562562e-03]
obj_value=-298.4772574746313
w=[3.47888220e-01 3.15261030e-11 1.08726735e-11 1.20862469e-11
 6.47225193e-01 2.37671029e-11 1.30126861e-10 4.92562562e-03]
obj_value=-298.47724114762116
w=[3.47888205e-01 1.49326873e-08 1.08726735e-11 1.20862469e-11
 6.47225193e-01 2.37671029e-11 1.30126861e-10 4.92562562e-03]
obj_value=-298.4772601031654
w=[3.47888205e-01 3.15261030e-11 1.49120339e-08 1.20862469e-11
 6.47225193e-01 2.37671029e-11 1.30126861e-10 4.92562562e-03]
obj_value=-298.47727446761405
w=[3.47888205e-01 3.15261030e-11 1.08726735e-11 1.49132474e-08
 6.47225193e-01 2.37671029e-11 1.30126861e-10 4.92562562e-03]
obj_value=-298.4772663163424
w=[3.47888205e-01 3.15261030e-11 1.08726735e-11 1.20862469e-11
 6.47225208e-01 2.37671029e-11 1.30126861e-10 4.92562562e-03]
obj_value=-298.47725941436204
w=[3.47888205e-01 3.15261030e-11 1.08726735e-11 1.20862469e-11
 6.47225193e-01 1.49249283e-08 1.30126861e-10 4.92562562e-03]
obj_value=-298.4772696475618
w=[3.47888205e-01 3.15261030e-11 1.08726735e-11 1.20862469e-11
 6.47225193e-01 2.37671029e-11 1.50312881e-08 4.92562562e-03]
obj_value=-298.47724578507103
w=[3.47888205e-01 3.15261030e-11 1.08726735e-11 1.20862469e-11
 6.47225193e-01 2.37671029e-11 1.30126861e-10 4.92564052e-03]
obj_value=-298.47725277875
w=[1.62703438e-03 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 9.99742499e-01 0.00000000e+00 1.58190367e-04]
obj_value=-6.883317422852216
w=[2.10823143e-01 1.90467157e-11 6.56880177e-12 7.30199063e-12
 3.91025628e-01 3.95741074e-01 7.86170536e-11 3.03846973e-03]
obj_value=-52.252759484774074
w=[3.03954533e-01 2.75260661e-11 9.49314698e-12 1.05527420e-11
 5.65105158e-01 1.26847487e-01 1.13616345e-10 4.32073268e-03]
obj_value=-265.43735888449504
w=[3.30102905e-01 2.99068016e-11 1.03142114e-11 1.14654510e-11
 6.13981228e-01 5.13506046e-02 1.23443047e-10 4.68075188e-03]
obj_value=-329.9011623828517
w=[3.30102920e-01 2.99068016e-11 1.03142114e-11 1.14654510e-11
 6.13981228e-01 5.13506046e-02 1.23443047e-10 4.68075188e-03]
obj_value=-329.9011549659666
w=[3.30102905e-01 1.49310680e-08 1.03142114e-11 1.14654510e-11
 6.13981228e-01 5.13506046e-02 1.23443047e-10 4.68075188e-03]
obj_value=-329.9011648985177
w=[3.30102905e-01 2.99068016e-11 1.49114754e-08 1.14654510e-11
 6.13981228e-01 5.13506046e-02 1.23443047e-10 4.68075188e-03]
obj_value=-329.9011748840139
w=[3.30102905e-01 2.99068016e-11 1.03142114e-11 1.49126266e-08
 6.13981228e-01 5.13506046e-02 1.23443047e-10 4.68075188e-03]
obj_value=-329.90116770227525
w=[3.30102905e-01 2.99068016e-11 1.03142114e-11 1.14654510e-11
 6.13981243e-01 5.13506046e-02 1.23443047e-10 4.68075188e-03]
obj_value=-329.90115896791855
w=[3.30102905e-01 2.99068016e-11 1.03142114e-11 1.14654510e-11
 6.13981228e-01 5.13506195e-02 1.23443047e-10 4.68075188e-03]
obj_value=-329.90115726354827
w=[3.30102905e-01 2.99068016e-11 1.03142114e-11 1.14654510e-11
 6.13981228e-01 5.13506046e-02 1.50246042e-08 4.68075188e-03]
obj_value=-329.9011312900542
w=[3.30102905e-01 2.99068016e-11 1.03142114e-11 1.14654510e-11
 6.13981228e-01 5.13506046e-02 1.23443047e-10 4.68076678e-03]
obj_value=-329.90113931054526
w=[1.65838666e-01 2.09543316e-04 8.33376317e-01 2.13346327e-04
 1.43658415e-03 0.00000000e+00 3.00756521e-05 0.00000000e+00]
obj_value=-6.895940486290349
w=[2.68900372e-01 7.80728956e-05 3.10504233e-01 7.94898323e-05
 3.85755754e-01 3.22180954e-02 1.12058402e-05 2.93676991e-03]
obj_value=-39.14097147414008
w=[3.13337911e-01 2.13862543e-05 8.50553280e-02 2.17743774e-05
 5.51464230e-01 4.61097039e-02 3.06966586e-06 4.20302906e-03]
obj_value=-233.0598006213136
w=[3.25918644e-01 5.33767219e-06 2.12283808e-02 5.43452735e-06
 5.98378036e-01 5.00425639e-02 7.66229656e-07 4.56152029e-03]
obj_value=-339.23481016506355
w=[3.25918659e-01 5.33767219e-06 2.12283808e-02 5.43452735e-06
 5.98378036e-01 5.00425639e-02 7.66229656e-07 4.56152029e-03]
obj_value=-339.2348137366177
w=[3.25918644e-01 5.35257335e-06 2.12283808e-02 5.43452735e-06
 5.98378036e-01 5.00425639e-02 7.66229656e-07 4.56152029e-03]
obj_value=-339.234812064319
w=[3.25918644e-01 5.33767219e-06 2.12283957e-02 5.43452735e-06
 5.98378036e-01 5.00425639e-02 7.66229656e-07 4.56152029e-03]
obj_value=-339.2347992194625
w=[3.25918644e-01 5.33767219e-06 2.12283808e-02 5.44942851e-06
 5.98378036e-01 5.00425639e-02 7.66229656e-07 4.56152029e-03]
obj_value=-339.234810289951
w=[3.25918644e-01 5.33767219e-06 2.12283808e-02 5.43452735e-06
 5.98378051e-01 5.00425639e-02 7.66229656e-07 4.56152029e-03]
obj_value=-339.23480104464625
w=[3.25918644e-01 5.33767219e-06 2.12283808e-02 5.43452735e-06
 5.98378036e-01 5.00425788e-02 7.66229656e-07 4.56152029e-03]
obj_value=-339.2348028963562
w=[3.25918644e-01 5.33767219e-06 2.12283808e-02 5.43452735e-06
 5.98378036e-01 5.00425639e-02 7.81130817e-07 4.56152029e-03]
obj_value=-339.23476049140595
w=[3.25918644e-01 5.33767219e-06 2.12283808e-02 5.43452735e-06
 5.98378036e-01 5.00425639e-02 7.66229656e-07 4.56153519e-03]
obj_value=-339.2347738950185
w=[7.10643263e-03 9.92904295e-01 1.44379393e-05 0.00000000e+00
 0.00000000e+00 1.56046686e-05 0.00000000e+00 2.14615219e-06]
obj_value=-31.57587419488219
w=[2.29774419e-01 2.99433958e-01 1.48308903e-02 3.79563649e-06
 4.17925122e-01 3.49559297e-02 5.35157716e-07 3.18654946e-03]
obj_value=-404.37166471295046
w=[2.29774434e-01 2.99433958e-01 1.48308903e-02 3.79563649e-06
 4.17925122e-01 3.49559297e-02 5.35157716e-07 3.18654946e-03]
obj_value=-404.3716734844907
w=[2.29774419e-01 2.99433973e-01 1.48308903e-02 3.79563649e-06
 4.17925122e-01 3.49559297e-02 5.35157716e-07 3.18654946e-03]
obj_value=-404.37165563966454
w=[2.29774419e-01 2.99433958e-01 1.48309052e-02 3.79563649e-06
 4.17925122e-01 3.49559297e-02 5.35157716e-07 3.18654946e-03]
obj_value=-404.3716363066803
w=[2.29774419e-01 2.99433958e-01 1.48308903e-02 3.81053765e-06
 4.17925122e-01 3.49559297e-02 5.35157716e-07 3.18654946e-03]
obj_value=-404.3716794958182
w=[2.29774419e-01 2.99433958e-01 1.48308903e-02 3.79563649e-06
 4.17925137e-01 3.49559297e-02 5.35157716e-07 3.18654946e-03]
obj_value=-404.37165439866874
w=[2.29774419e-01 2.99433958e-01 1.48308903e-02 3.79563649e-06
 4.17925122e-01 3.49559446e-02 5.35157716e-07 3.18654946e-03]
obj_value=-404.37165121635843
w=[2.29774419e-01 2.99433958e-01 1.48308903e-02 3.79563649e-06
 4.17925122e-01 3.49559297e-02 5.50058877e-07 3.18654946e-03]
obj_value=-404.3715803744732
w=[2.29774419e-01 2.99433958e-01 1.48308903e-02 3.79563649e-06
 4.17925122e-01 3.49559297e-02 5.35157716e-07 3.18656436e-03]
obj_value=-404.37162687353907
w=[1.44371061e-01 5.13098279e-01 1.65304184e-06 3.42529382e-01
 0.00000000e+00 1.86930722e-06 1.08111067e-07 1.05041826e-07]
obj_value=-110.3057599063506
w=[2.02558645e-01 3.67523082e-01 1.01052077e-02 1.09157570e-01
 2.84743526e-01 2.38170023e-02 3.99069332e-07 2.17111456e-03]
obj_value=-431.79429386210603
w=[2.02558660e-01 3.67523082e-01 1.01052077e-02 1.09157570e-01
 2.84743526e-01 2.38170023e-02 3.99069332e-07 2.17111456e-03]
obj_value=-431.794338344482
w=[2.02558645e-01 3.67523097e-01 1.01052077e-02 1.09157570e-01
 2.84743526e-01 2.38170023e-02 3.99069332e-07 2.17111456e-03]
obj_value=-431.7942850649148
w=[2.02558645e-01 3.67523082e-01 1.01052226e-02 1.09157570e-01
 2.84743526e-01 2.38170023e-02 3.99069332e-07 2.17111456e-03]
obj_value=-431.79424855413026
w=[2.02558645e-01 3.67523082e-01 1.01052077e-02 1.09157585e-01
 2.84743526e-01 2.38170023e-02 3.99069332e-07 2.17111456e-03]
obj_value=-431.7942565130192
w=[2.02558645e-01 3.67523082e-01 1.01052077e-02 1.09157570e-01
 2.84743540e-01 2.38170023e-02 3.99069332e-07 2.17111456e-03]
obj_value=-431.79426870348976
w=[2.02558645e-01 3.67523082e-01 1.01052077e-02 1.09157570e-01
 2.84743526e-01 2.38170172e-02 3.99069332e-07 2.17111456e-03]
obj_value=-431.794281919074
w=[2.02558645e-01 3.67523082e-01 1.01052077e-02 1.09157570e-01
 2.84743526e-01 2.38170023e-02 4.13970493e-07 2.17111456e-03]
obj_value=-431.7941306584355
w=[2.02558645e-01 3.67523082e-01 1.01052077e-02 1.09157570e-01
 2.84743526e-01 2.38170023e-02 3.99069332e-07 2.17112946e-03]
obj_value=-431.79418870211833
w=[5.25236190e-01 0.00000000e+00 1.70556097e-01 3.09887325e-01
 0.00000000e+00 1.67021617e-03 0.00000000e+00 2.69691023e-04]
obj_value=-33.17308559733981
w=[3.05254696e-01 2.50554394e-01 6.11706534e-02 1.73042254e-01
 1.94120437e-01 1.67685184e-02 2.72060666e-07 1.56596340e-03]
obj_value=-175.19929143038863
w=[2.26415245e-01 3.40350906e-01 2.19678634e-02 1.23998173e-01
 2.63691511e-01 2.21796184e-02 3.69564839e-07 2.03053613e-03]
obj_value=-428.97594991917987
w=[2.13844796e-01 3.54668388e-01 1.57172281e-02 1.16178407e-01
 2.74784176e-01 2.30423839e-02 3.85111258e-07 2.10460930e-03]
obj_value=-444.04950836575233
w=[2.13844811e-01 3.54668388e-01 1.57172281e-02 1.16178407e-01
 2.74784176e-01 2.30423839e-02 3.85111258e-07 2.10460930e-03]
obj_value=-444.0495237594118
w=[2.13844796e-01 3.54668403e-01 1.57172281e-02 1.16178407e-01
 2.74784176e-01 2.30423839e-02 3.85111258e-07 2.10460930e-03]
obj_value=-444.04950022659864
w=[2.13844796e-01 3.54668388e-01 1.57172430e-02 1.16178407e-01
 2.74784176e-01 2.30423839e-02 3.85111258e-07 2.10460930e-03]
obj_value=-444.04946986159507
w=[2.13844796e-01 3.54668388e-01 1.57172281e-02 1.16178422e-01
 2.74784176e-01 2.30423839e-02 3.85111258e-07 2.10460930e-03]
obj_value=-444.04948174757106
w=[2.13844796e-01 3.54668388e-01 1.57172281e-02 1.16178407e-01
 2.74784191e-01 2.30423839e-02 3.85111258e-07 2.10460930e-03]
obj_value=-444.0494975444655
w=[2.13844796e-01 3.54668388e-01 1.57172281e-02 1.16178407e-01
 2.74784176e-01 2.30423988e-02 3.85111258e-07 2.10460930e-03]
obj_value=-444.04950263666177
w=[2.13844796e-01 3.54668388e-01 1.57172281e-02 1.16178407e-01
 2.74784176e-01 2.30423839e-02 4.00012420e-07 2.10460930e-03]
obj_value=-444.0493555548395
w=[2.13844796e-01 3.54668388e-01 1.57172281e-02 1.16178407e-01
 2.74784176e-01 2.30423839e-02 3.85111258e-07 2.10462420e-03]
obj_value=-444.04940440826647
w=[3.47327040e-01 1.85869780e-04 1.47033486e-05 4.06430436e-05
 6.52245552e-01 1.67732109e-04 1.12114012e-06 1.73388513e-05]
obj_value=-295.31798747377496
w=[2.59808915e-01 2.32603638e-01 1.03101215e-02 7.61867955e-02
 4.04761611e-01 1.51655818e-02 6.38560088e-07 1.38586541e-03]
obj_value=-481.18951553461756
w=[2.59808930e-01 2.32603638e-01 1.03101215e-02 7.61867955e-02
 4.04761611e-01 1.51655818e-02 6.38560088e-07 1.38586541e-03]
obj_value=-481.1895059154347
w=[2.59808915e-01 2.32603653e-01 1.03101215e-02 7.61867955e-02
 4.04761611e-01 1.51655818e-02 6.38560088e-07 1.38586541e-03]
obj_value=-481.18951236078476
w=[2.59808915e-01 2.32603638e-01 1.03101364e-02 7.61867955e-02
 4.04761611e-01 1.51655818e-02 6.38560088e-07 1.38586541e-03]
obj_value=-481.18950529407834
w=[2.59808915e-01 2.32603638e-01 1.03101215e-02 7.61868104e-02
 4.04761611e-01 1.51655818e-02 6.38560088e-07 1.38586541e-03]
obj_value=-481.18950546800056
w=[2.59808915e-01 2.32603638e-01 1.03101215e-02 7.61867955e-02
 4.04761626e-01 1.51655818e-02 6.38560088e-07 1.38586541e-03]
obj_value=-481.1895078174569
w=[2.59808915e-01 2.32603638e-01 1.03101215e-02 7.61867955e-02
 4.04761611e-01 1.51655967e-02 6.38560088e-07 1.38586541e-03]
obj_value=-481.1895238675115
w=[2.59808915e-01 2.32603638e-01 1.03101215e-02 7.61867955e-02
 4.04761611e-01 1.51655818e-02 6.53461249e-07 1.38586541e-03]
obj_value=-481.18942388535294
w=[2.59808915e-01 2.32603638e-01 1.03101215e-02 7.61867955e-02
 4.04761611e-01 1.51655818e-02 6.38560088e-07 1.38588031e-03]
obj_value=-481.18947001939534
w=[2.79668618e-01 3.06118464e-05 1.26434462e-07 1.83352568e-05
 3.05648101e-01 4.14637293e-01 5.18558045e-06 0.00000000e+00]
obj_value=-52.54186708746716
w=[2.64437549e-01 1.78398625e-01 7.90720564e-03 5.84344685e-02
 3.81661558e-01 1.08269111e-01 1.69831884e-06 1.06286641e-03]
obj_value=-352.81285218915536
w=[2.60745217e-01 2.21638790e-01 9.82404827e-03 7.25957703e-02
 4.00088822e-01 3.39990070e-02 8.52933135e-07 1.32052763e-03]
obj_value=-487.8589109086252
w=[2.60745232e-01 2.21638790e-01 9.82404827e-03 7.25957703e-02
 4.00088822e-01 3.39990070e-02 8.52933135e-07 1.32052763e-03]
obj_value=-487.8588943003268
w=[2.60745217e-01 2.21638805e-01 9.82404827e-03 7.25957703e-02
 4.00088822e-01 3.39990070e-02 8.52933135e-07 1.32052763e-03]
obj_value=-487.85890766831403
w=[2.60745217e-01 2.21638790e-01 9.82406317e-03 7.25957703e-02
 4.00088822e-01 3.39990070e-02 8.52933135e-07 1.32052763e-03]
obj_value=-487.8589059678201
w=[2.60745217e-01 2.21638790e-01 9.82404827e-03 7.25957852e-02
 4.00088822e-01 3.39990070e-02 8.52933135e-07 1.32052763e-03]
obj_value=-487.85890621308283
w=[2.60745217e-01 2.21638790e-01 9.82404827e-03 7.25957703e-02
 4.00088837e-01 3.39990070e-02 8.52933135e-07 1.32052763e-03]
obj_value=-487.858907074058
w=[2.60745217e-01 2.21638790e-01 9.82404827e-03 7.25957703e-02
 4.00088822e-01 3.39990219e-02 8.52933135e-07 1.32052763e-03]
obj_value=-487.85890412244015
w=[2.60745217e-01 2.21638790e-01 9.82404827e-03 7.25957703e-02
 4.00088822e-01 3.39990070e-02 8.67834296e-07 1.32052763e-03]
obj_value=-487.8588208943108
w=[2.60745217e-01 2.21638790e-01 9.82404827e-03 7.25957703e-02
 4.00088822e-01 3.39990070e-02 8.52933135e-07 1.32054253e-03]
obj_value=-487.8588604906066
w=[1.67439092e-01 5.73151220e-01 4.99392424e-07 0.00000000e+00
 2.56058376e-01 3.35761756e-03 7.06502546e-06 0.00000000e+00]
obj_value=-202.5783522529131
w=[2.47825994e-01 2.70309418e-01 8.46387363e-03 6.25441152e-02
 3.80146278e-01 2.97563814e-02 1.71306327e-06 1.13768656e-03]
obj_value=-492.54607790274775
w=[2.47826009e-01 2.70309418e-01 8.46387363e-03 6.25441152e-02
 3.80146278e-01 2.97563814e-02 1.71306327e-06 1.13768656e-03]
obj_value=-492.54604805622625
w=[2.47825994e-01 2.70309433e-01 8.46387363e-03 6.25441152e-02
 3.80146278e-01 2.97563814e-02 1.71306327e-06 1.13768656e-03]
obj_value=-492.54607111324935
w=[2.47825994e-01 2.70309418e-01 8.46388853e-03 6.25441152e-02
 3.80146278e-01 2.97563814e-02 1.71306327e-06 1.13768656e-03]
obj_value=-492.5460789428051
w=[2.47825994e-01 2.70309418e-01 8.46387363e-03 6.25441301e-02
 3.80146278e-01 2.97563814e-02 1.71306327e-06 1.13768656e-03]
obj_value=-492.54608741840434
w=[2.47825994e-01 2.70309418e-01 8.46387363e-03 6.25441152e-02
 3.80146293e-01 2.97563814e-02 1.71306327e-06 1.13768656e-03]
obj_value=-492.54608165494955
w=[2.47825994e-01 2.70309418e-01 8.46387363e-03 6.25441152e-02
 3.80146278e-01 2.97563963e-02 1.71306327e-06 1.13768656e-03]
obj_value=-492.5460744870297
w=[2.47825994e-01 2.70309418e-01 8.46387363e-03 6.25441152e-02
 3.80146278e-01 2.97563814e-02 1.72796443e-06 1.13768656e-03]
obj_value=-492.546000836898
w=[2.47825994e-01 2.70309418e-01 8.46387363e-03 6.25441152e-02
 3.80146278e-01 2.97563814e-02 1.71306327e-06 1.13770146e-03]
obj_value=-492.54604619358383
w=[1.31193671e-01 5.84577753e-01 2.71721197e-08 2.52745439e-01
 7.64091231e-06 3.14738031e-02 2.95005465e-06 0.00000000e+00]
obj_value=-167.05201424214115
w=[2.32340598e-01 3.12035153e-01 7.34011989e-03 8.77973438e-02
 3.29674873e-01 2.99844052e-02 1.87729991e-06 9.86634727e-04]
obj_value=-494.37141437889005
w=[2.32340613e-01 3.12035153e-01 7.34011989e-03 8.77973438e-02
 3.29674873e-01 2.99844052e-02 1.87729991e-06 9.86634727e-04]
obj_value=-494.3713935538077
w=[2.32340598e-01 3.12035168e-01 7.34011989e-03 8.77973438e-02
 3.29674873e-01 2.99844052e-02 1.87729991e-06 9.86634727e-04]
obj_value=-494.3714061414172
w=[2.32340598e-01 3.12035153e-01 7.34013479e-03 8.77973438e-02
 3.29674873e-01 2.99844052e-02 1.87729991e-06 9.86634727e-04]
obj_value=-494.3714104610172
w=[2.32340598e-01 3.12035153e-01 7.34011989e-03 8.77973587e-02
 3.29674873e-01 2.99844052e-02 1.87729991e-06 9.86634727e-04]
obj_value=-494.37141100903636
w=[2.32340598e-01 3.12035153e-01 7.34011989e-03 8.77973438e-02
 3.29674888e-01 2.99844052e-02 1.87729991e-06 9.86634727e-04]
obj_value=-494.3714162253917
w=[2.32340598e-01 3.12035153e-01 7.34011989e-03 8.77973438e-02
 3.29674873e-01 2.99844201e-02 1.87729991e-06 9.86634727e-04]
obj_value=-494.37140808781004
w=[2.32340598e-01 3.12035153e-01 7.34011989e-03 8.77973438e-02
 3.29674873e-01 2.99844052e-02 1.89220107e-06 9.86634727e-04]
obj_value=-494.3713115983777
w=[2.32340598e-01 3.12035153e-01 7.34011989e-03 8.77973438e-02
 3.29674873e-01 2.99844052e-02 1.87729991e-06 9.86649628e-04]
obj_value=-494.37136053854044
w=[2.40234634e-01 2.40116174e-01 0.00000000e+00 7.91702310e-02
 4.14713464e-01 2.57641979e-02 4.06813902e-06 0.00000000e+00]
obj_value=-442.4663487112751
w=[2.34249512e-01 2.94643906e-01 5.56515250e-03 8.57111594e-02
 3.50238669e-01 2.89638864e-02 2.40708253e-06 7.48049460e-04]
obj_value=-499.6992249167958
w=[2.34249527e-01 2.94643906e-01 5.56515250e-03 8.57111594e-02
 3.50238669e-01 2.89638864e-02 2.40708253e-06 7.48049460e-04]
obj_value=-499.6992255098373
w=[2.34249512e-01 2.94643921e-01 5.56515250e-03 8.57111594e-02
 3.50238669e-01 2.89638864e-02 2.40708253e-06 7.48049460e-04]
obj_value=-499.6992175758664
w=[2.34249512e-01 2.94643906e-01 5.56516740e-03 8.57111594e-02
 3.50238669e-01 2.89638864e-02 2.40708253e-06 7.48049460e-04]
obj_value=-499.6992131661826
w=[2.34249512e-01 2.94643906e-01 5.56515250e-03 8.57111743e-02
 3.50238669e-01 2.89638864e-02 2.40708253e-06 7.48049460e-04]
obj_value=-499.69920949449465
w=[2.34249512e-01 2.94643906e-01 5.56515250e-03 8.57111594e-02
 3.50238684e-01 2.89638864e-02 2.40708253e-06 7.48049460e-04]
obj_value=-499.6992142152052
w=[2.34249512e-01 2.94643906e-01 5.56515250e-03 8.57111594e-02
 3.50238669e-01 2.89639013e-02 2.40708253e-06 7.48049460e-04]
obj_value=-499.6992164108006
w=[2.34249512e-01 2.94643906e-01 5.56515250e-03 8.57111594e-02
 3.50238669e-01 2.89638864e-02 2.42198369e-06 7.48049460e-04]
obj_value=-499.6991148476137
w=[2.34249512e-01 2.94643906e-01 5.56515250e-03 8.57111594e-02
 3.50238669e-01 2.89638864e-02 2.40708253e-06 7.48064361e-04]
obj_value=-499.69917135251666
w=[2.38671476e-01 2.87585394e-01 9.69485796e-08 7.69566121e-02
 3.66787829e-01 2.99968490e-02 6.33373463e-06 0.00000000e+00]
obj_value=-499.76745268926504
w=[2.36499140e-01 2.91052961e-01 2.73398863e-03 8.12573749e-02
 3.58657881e-01 2.94893953e-02 4.40472576e-06 3.67487113e-04]
obj_value=-501.54558541031327
w=[2.36499155e-01 2.91052961e-01 2.73398863e-03 8.12573749e-02
 3.58657881e-01 2.94893953e-02 4.40472576e-06 3.67487113e-04]
obj_value=-501.5455779862611
w=[2.36499140e-01 2.91052976e-01 2.73398863e-03 8.12573749e-02
 3.58657881e-01 2.94893953e-02 4.40472576e-06 3.67487113e-04]
obj_value=-501.5455782355896
w=[2.36499140e-01 2.91052961e-01 2.73400353e-03 8.12573749e-02
 3.58657881e-01 2.94893953e-02 4.40472576e-06 3.67487113e-04]
obj_value=-501.545585162399
w=[2.36499140e-01 2.91052961e-01 2.73398863e-03 8.12573898e-02
 3.58657881e-01 2.94893953e-02 4.40472576e-06 3.67487113e-04]
obj_value=-501.5455758361203
w=[2.36499140e-01 2.91052961e-01 2.73398863e-03 8.12573749e-02
 3.58657896e-01 2.94893953e-02 4.40472576e-06 3.67487113e-04]
obj_value=-501.5455781050244
w=[2.36499140e-01 2.91052961e-01 2.73398863e-03 8.12573749e-02
 3.58657881e-01 2.94894102e-02 4.40472576e-06 3.67487113e-04]
obj_value=-501.5455780116803
w=[2.36499140e-01 2.91052961e-01 2.73398863e-03 8.12573749e-02
 3.58657881e-01 2.94893953e-02 4.41962692e-06 3.67487113e-04]
obj_value=-501.5454966182779
w=[2.36499140e-01 2.91052961e-01 2.73398863e-03 8.12573749e-02
 3.58657881e-01 2.94893953e-02 4.40472576e-06 3.67502014e-04]
obj_value=-501.5455519606988
w=[2.69831326e-01 2.08201375e-01 4.65295392e-02 0.00000000e+00
 4.43996689e-01 3.14404732e-02 4.71478018e-06 0.00000000e+00]
obj_value=-360.1009961937435
w=[2.39832359e-01 2.82767803e-01 7.11354369e-03 7.31316374e-02
 3.67191762e-01 2.96845031e-02 4.43573120e-06 3.30738401e-04]
obj_value=-502.2987176605562
w=[2.39832374e-01 2.82767803e-01 7.11354369e-03 7.31316374e-02
 3.67191762e-01 2.96845031e-02 4.43573120e-06 3.30738401e-04]
obj_value=-502.2987078052939
w=[2.39832359e-01 2.82767818e-01 7.11354369e-03 7.31316374e-02
 3.67191762e-01 2.96845031e-02 4.43573120e-06 3.30738401e-04]
obj_value=-502.2987102089101
w=[2.39832359e-01 2.82767803e-01 7.11355859e-03 7.31316374e-02
 3.67191762e-01 2.96845031e-02 4.43573120e-06 3.30738401e-04]
obj_value=-502.2987090116013
w=[2.39832359e-01 2.82767803e-01 7.11354369e-03 7.31316523e-02
 3.67191762e-01 2.96845031e-02 4.43573120e-06 3.30738401e-04]
obj_value=-502.2987129123483
w=[2.39832359e-01 2.82767803e-01 7.11354369e-03 7.31316374e-02
 3.67191777e-01 2.96845031e-02 4.43573120e-06 3.30738401e-04]
obj_value=-502.2987111740302
w=[2.39832359e-01 2.82767803e-01 7.11354369e-03 7.31316374e-02
 3.67191762e-01 2.96845180e-02 4.43573120e-06 3.30738401e-04]
obj_value=-502.2987104651678
w=[2.39832359e-01 2.82767803e-01 7.11354369e-03 7.31316374e-02
 3.67191762e-01 2.96845031e-02 4.45063237e-06 3.30738401e-04]
obj_value=-502.29863286297024
w=[2.39832359e-01 2.82767803e-01 7.11354369e-03 7.31316374e-02
 3.67191762e-01 2.96845031e-02 4.43573120e-06 3.30753302e-04]
obj_value=-502.29868859507593
w=[2.37665515e-01 2.87740761e-01 6.33893894e-03 7.80287028e-02
 3.60519361e-01 2.97078752e-02 0.00000000e+00 6.88795317e-06]
obj_value=-503.15068851480856
w=[2.37665530e-01 2.87740761e-01 6.33893894e-03 7.80287028e-02
 3.60519361e-01 2.97078752e-02 0.00000000e+00 6.88795317e-06]
obj_value=-503.1506814559683
w=[2.37665515e-01 2.87740776e-01 6.33893894e-03 7.80287028e-02
 3.60519361e-01 2.97078752e-02 0.00000000e+00 6.88795317e-06]
obj_value=-503.1506810080823
w=[2.37665515e-01 2.87740761e-01 6.33895384e-03 7.80287028e-02
 3.60519361e-01 2.97078752e-02 0.00000000e+00 6.88795317e-06]
obj_value=-503.1506800869251
w=[2.37665515e-01 2.87740761e-01 6.33893894e-03 7.80287177e-02
 3.60519361e-01 2.97078752e-02 0.00000000e+00 6.88795317e-06]
obj_value=-503.1506805310668
w=[2.37665515e-01 2.87740761e-01 6.33893894e-03 7.80287028e-02
 3.60519376e-01 2.97078752e-02 0.00000000e+00 6.88795317e-06]
obj_value=-503.1506808648826
w=[2.37665515e-01 2.87740761e-01 6.33893894e-03 7.80287028e-02
 3.60519361e-01 2.97078901e-02 0.00000000e+00 6.88795317e-06]
obj_value=-503.15068092746174
w=[2.37665515e-01 2.87740761e-01 6.33893894e-03 7.80287028e-02
 3.60519361e-01 2.97078752e-02 1.49011612e-08 6.88795317e-06]
obj_value=-503.1506065567715
w=[2.37665515e-01 2.87740761e-01 6.33893894e-03 7.80287028e-02
 3.60519361e-01 2.97078752e-02 0.00000000e+00 6.90285433e-06]
obj_value=-503.1506636962657
w=[2.37779081e-01 2.87520529e-01 5.96944953e-03 7.72662200e-02
 3.61774167e-01 2.96905013e-02 9.27700545e-07 0.00000000e+00]
obj_value=-503.1736023462881
w=[2.37779096e-01 2.87520529e-01 5.96944953e-03 7.72662200e-02
 3.61774167e-01 2.96905013e-02 9.27700545e-07 0.00000000e+00]
obj_value=-503.17359489604746
w=[2.37779081e-01 2.87520544e-01 5.96944953e-03 7.72662200e-02
 3.61774167e-01 2.96905013e-02 9.27700545e-07 0.00000000e+00]
obj_value=-503.17359483648846
w=[2.37779081e-01 2.87520529e-01 5.96946443e-03 7.72662200e-02
 3.61774167e-01 2.96905013e-02 9.27700545e-07 0.00000000e+00]
obj_value=-503.1735949732317
w=[2.37779081e-01 2.87520529e-01 5.96944953e-03 7.72662349e-02
 3.61774167e-01 2.96905013e-02 9.27700545e-07 0.00000000e+00]
obj_value=-503.17359487511493
w=[2.37779081e-01 2.87520529e-01 5.96944953e-03 7.72662200e-02
 3.61774182e-01 2.96905013e-02 9.27700545e-07 0.00000000e+00]
obj_value=-503.17359482029724
w=[2.37779081e-01 2.87520529e-01 5.96944953e-03 7.72662200e-02
 3.61774167e-01 2.96905162e-02 9.27700545e-07 0.00000000e+00]
obj_value=-503.1735948326696
w=[2.37779081e-01 2.87520529e-01 5.96944953e-03 7.72662200e-02
 3.61774167e-01 2.96905013e-02 9.42601706e-07 0.00000000e+00]
obj_value=-503.1735217612791
w=[2.37779081e-01 2.87520529e-01 5.96944953e-03 7.72662200e-02
 3.61774167e-01 2.96905013e-02 9.27700545e-07 1.49011612e-08]
obj_value=-503.17357892429663
w=[0.00000000e+00 0.00000000e+00 9.99997632e-01 0.00000000e+00
 0.00000000e+00 0.00000000e+00 1.30828911e-05 1.01654577e-06]
obj_value=-3.7977337383836645
w=[2.14001173e-01 2.58768476e-01 1.05372268e-01 6.95395980e-02
 3.25596750e-01 2.67214512e-02 2.14321960e-06 1.01654577e-07]
obj_value=-155.6083226478795
w=[2.35401291e-01 2.84645323e-01 1.59097314e-02 7.64935578e-02
 3.58156425e-01 2.93935963e-02 1.04925245e-06 1.01654577e-08]
obj_value=-491.4433726890107
w=[2.37541302e-01 2.87233008e-01 6.96347772e-03 7.71889538e-02
 3.61412393e-01 2.96608108e-02 9.39855736e-07 1.01654577e-09]
obj_value=-503.0600852957276
w=[2.37755303e-01 2.87491777e-01 6.06885235e-03 7.72584934e-02
 3.61737989e-01 2.96875322e-02 9.28916064e-07 1.01654577e-10]
obj_value=-503.173213616205
w=[2.37770986e-01 2.87510740e-01 6.00329095e-03 7.72635895e-02
 3.61761850e-01 2.96894905e-02 9.28114365e-07 3.46080189e-11]
obj_value=-503.17374380839857
w=[2.37771001e-01 2.87510740e-01 6.00329095e-03 7.72635895e-02
 3.61761850e-01 2.96894905e-02 9.28114365e-07 3.46080189e-11]
obj_value=-503.1737364362583
w=[2.37770986e-01 2.87510755e-01 6.00329095e-03 7.72635895e-02
 3.61761850e-01 2.96894905e-02 9.28114365e-07 3.46080189e-11]
obj_value=-503.1737362958029
w=[2.37770986e-01 2.87510740e-01 6.00330585e-03 7.72635895e-02
 3.61761850e-01 2.96894905e-02 9.28114365e-07 3.46080189e-11]
obj_value=-503.1737363116146
w=[2.37770986e-01 2.87510740e-01 6.00329095e-03 7.72636044e-02
 3.61761850e-01 2.96894905e-02 9.28114365e-07 3.46080189e-11]
obj_value=-503.17373630051594
w=[2.37770986e-01 2.87510740e-01 6.00329095e-03 7.72635895e-02
 3.61761865e-01 2.96894905e-02 9.28114365e-07 3.46080189e-11]
obj_value=-503.173736244286
w=[2.37770986e-01 2.87510740e-01 6.00329095e-03 7.72635895e-02
 3.61761850e-01 2.96895054e-02 9.28114365e-07 3.46080189e-11]
obj_value=-503.17373628125773
w=[2.37770986e-01 2.87510740e-01 6.00329095e-03 7.72635895e-02
 3.61761850e-01 2.96894905e-02 9.43015526e-07 3.46080189e-11]
obj_value=-503.1736631276719
w=[2.37770986e-01 2.87510740e-01 6.00329095e-03 7.72635895e-02
 3.61761850e-01 2.96894905e-02 9.28114365e-07 1.49357692e-08]
obj_value=-503.17372031901266
w=[6.13020261e-01 2.88661520e-08 3.86996091e-01 2.59569484e-06
 0.00000000e+00 3.17013413e-06 0.00000000e+00 0.00000000e+00]
obj_value=-15.57705767274466
w=[2.75295914e-01 2.58759669e-01 4.41025709e-02 6.95374901e-02
 3.25585665e-01 2.67208584e-02 8.35302929e-07 3.11472170e-11]
obj_value=-327.49157304791066
w=[2.41523479e-01 2.84635633e-01 9.81321894e-03 7.64909796e-02
 3.58144232e-01 2.93926273e-02 9.18833221e-07 3.42619387e-11]
obj_value=-500.3286508882877
w=[2.38146236e-01 2.87223229e-01 6.38428375e-03 7.71863285e-02
 3.61400088e-01 2.96598042e-02 9.27186251e-07 3.45734109e-11]
obj_value=-503.1495779852484
w=[2.37808511e-01 2.87481989e-01 6.04139023e-03 7.72558634e-02
 3.61725674e-01 2.96865218e-02 9.28021554e-07 3.46045581e-11]
obj_value=-503.17396914194836
w=[2.37808526e-01 2.87481989e-01 6.04139023e-03 7.72558634e-02
 3.61725674e-01 2.96865218e-02 9.28021554e-07 3.46045581e-11]
obj_value=-503.1739616269703
w=[2.37808511e-01 2.87482004e-01 6.04139023e-03 7.72558634e-02
 3.61725674e-01 2.96865218e-02 9.28021554e-07 3.46045581e-11]
obj_value=-503.17396162949404
w=[2.37808511e-01 2.87481989e-01 6.04140513e-03 7.72558634e-02
 3.61725674e-01 2.96865218e-02 9.28021554e-07 3.46045581e-11]
obj_value=-503.17396164516526
w=[2.37808511e-01 2.87481989e-01 6.04139023e-03 7.72558783e-02
 3.61725674e-01 2.96865218e-02 9.28021554e-07 3.46045581e-11]
obj_value=-503.1739617123949
w=[2.37808511e-01 2.87481989e-01 6.04139023e-03 7.72558634e-02
 3.61725689e-01 2.96865218e-02 9.28021554e-07 3.46045581e-11]
obj_value=-503.17396165242974
w=[2.37808511e-01 2.87481989e-01 6.04139023e-03 7.72558634e-02
 3.61725674e-01 2.96865367e-02 9.28021554e-07 3.46045581e-11]
obj_value=-503.1739616445291
w=[2.37808511e-01 2.87481989e-01 6.04139023e-03 7.72558634e-02
 3.61725674e-01 2.96865218e-02 9.42922715e-07 3.46045581e-11]
obj_value=-503.173888541284
w=[2.37808511e-01 2.87481989e-01 6.04139023e-03 7.72558634e-02
 3.61725674e-01 2.96865218e-02 9.28021554e-07 1.49357658e-08]
obj_value=-503.1739456853308
w=[3.43208954e-01 1.45388767e-06 3.10169470e-02 6.25776281e-01
 1.56075868e-06 1.08874111e-06 0.00000000e+00 0.00000000e+00]
obj_value=-54.06760338281197
w=[2.48348555e-01 2.58733936e-01 8.53894590e-03 1.32107905e-01
 3.25553263e-01 2.67179785e-02 8.35219398e-07 3.11441023e-11]
obj_value=-451.64790096496176
w=[2.38862516e-01 2.84607184e-01 6.29114579e-03 8.27410676e-02
 3.58108433e-01 2.93896675e-02 9.18741338e-07 3.42585125e-11]
obj_value=-502.60017712262095
w=[2.37913912e-01 2.87194509e-01 6.06636578e-03 7.78043838e-02
 3.61363950e-01 2.96568364e-02 9.27093532e-07 3.45699536e-11]
obj_value=-503.170429079305
w=[2.37830189e-01 2.87422863e-01 6.04652695e-03 7.73686776e-02
 3.61651278e-01 2.96804164e-02 9.27830687e-07 3.45974410e-11]
obj_value=-503.1742237477901
w=[2.37830204e-01 2.87422863e-01 6.04652695e-03 7.73686776e-02
 3.61651278e-01 2.96804164e-02 9.27830687e-07 3.45974410e-11]
obj_value=-503.1742162328278
w=[2.37830189e-01 2.87422878e-01 6.04652695e-03 7.73686776e-02
 3.61651278e-01 2.96804164e-02 9.27830687e-07 3.45974410e-11]
obj_value=-503.17421624705247
w=[2.37830189e-01 2.87422863e-01 6.04654185e-03 7.73686776e-02
 3.61651278e-01 2.96804164e-02 9.27830687e-07 3.45974410e-11]
obj_value=-503.1742162510126
w=[2.37830189e-01 2.87422863e-01 6.04652695e-03 7.73686925e-02
 3.61651278e-01 2.96804164e-02 9.27830687e-07 3.45974410e-11]
obj_value=-503.1742162592794
w=[2.37830189e-01 2.87422863e-01 6.04652695e-03 7.73686776e-02
 3.61651293e-01 2.96804164e-02 9.27830687e-07 3.45974410e-11]
obj_value=-503.174216260325
w=[2.37830189e-01 2.87422863e-01 6.04652695e-03 7.73686776e-02
 3.61651278e-01 2.96804313e-02 9.27830687e-07 3.45974410e-11]
obj_value=-503.1742162650535
w=[2.37830189e-01 2.87422863e-01 6.04652695e-03 7.73686776e-02
 3.61651278e-01 2.96804164e-02 9.42731849e-07 3.45974410e-11]
obj_value=-503.1741430814271
w=[2.37830189e-01 2.87422863e-01 6.04652695e-03 7.73686776e-02
 3.61651278e-01 2.96804164e-02 9.27830687e-07 1.49357586e-08]
obj_value=-503.17420019438225
w=[0.22138791 0.         0.0207018  0.14320667 0.04741332 0.56731104
 0.         0.        ]
obj_value=-29.69149833043665
w=[2.36185961e-01 2.58680577e-01 7.51205461e-03 8.39524769e-02
 3.30227482e-01 8.34434784e-02 8.35047619e-07 3.11376969e-11]
obj_value=-421.32877776882344
w=[2.37665766e-01 2.84548634e-01 6.19307972e-03 7.80270575e-02
 3.58508899e-01 3.50567226e-02 9.18552380e-07 3.42514666e-11]
obj_value=-502.18082903465097
w=[2.37813747e-01 2.87135440e-01 6.06118223e-03 7.74345156e-02
 3.61337040e-01 3.02180471e-02 9.26902857e-07 3.45628436e-11]
obj_value=-503.16464207107043
w=[2.37828545e-01 2.87394121e-01 6.04799248e-03 7.73752614e-02
 3.61619854e-01 2.97341795e-02 9.27737904e-07 3.45939813e-11]
obj_value=-503.1741673202427
w=[2.37829833e-01 2.87416643e-01 6.04684409e-03 7.73701024e-02
 3.61644478e-01 2.96920508e-02 9.27810609e-07 3.45966923e-11]
obj_value=-503.17422853123963
w=[2.37829848e-01 2.87416643e-01 6.04684409e-03 7.73701024e-02
 3.61644478e-01 2.96920508e-02 9.27810609e-07 3.45966923e-11]
obj_value=-503.1742210162795
w=[2.37829833e-01 2.87416658e-01 6.04684409e-03 7.73701024e-02
 3.61644478e-01 2.96920508e-02 9.27810609e-07 3.45966923e-11]
obj_value=-503.1742210306661
w=[2.37829833e-01 2.87416643e-01 6.04685899e-03 7.73701024e-02
 3.61644478e-01 2.96920508e-02 9.27810609e-07 3.45966923e-11]
obj_value=-503.17422103446415
w=[2.37829833e-01 2.87416643e-01 6.04684409e-03 7.73701173e-02
 3.61644478e-01 2.96920508e-02 9.27810609e-07 3.45966923e-11]
obj_value=-503.1742210427291
w=[2.37829833e-01 2.87416643e-01 6.04684409e-03 7.73701024e-02
 3.61644493e-01 2.96920508e-02 9.27810609e-07 3.45966923e-11]
obj_value=-503.1742210445835
w=[2.37829833e-01 2.87416643e-01 6.04684409e-03 7.73701024e-02
 3.61644478e-01 2.96920657e-02 9.27810609e-07 3.45966923e-11]
obj_value=-503.17422103704104
w=[2.37829833e-01 2.87416643e-01 6.04684409e-03 7.73701024e-02
 3.61644478e-01 2.96920508e-02 9.42711770e-07 3.45966923e-11]
obj_value=-503.17414786037995
w=[2.37829833e-01 2.87416643e-01 6.04684409e-03 7.73701024e-02
 3.61644478e-01 2.96920508e-02 9.27810609e-07 1.49357579e-08]
obj_value=-503.17420496848194
w=[5.98622073e-06 6.00277108e-06 5.99581175e-06 2.95645376e-01
 7.04366621e-01 5.99739078e-06 0.00000000e+00 0.00000000e+00]
obj_value=-7.399458559132972
w=[2.14047448e-01 2.58675579e-01 5.44275926e-03 9.91976298e-02
 3.95916692e-01 2.67234455e-02 8.35029548e-07 3.11370231e-11]
obj_value=-297.6143116086197
w=[2.35451595e-01 2.84542537e-01 5.98643561e-03 7.95528551e-02
 3.65071699e-01 2.93951903e-02 9.18532503e-07 3.42507254e-11]
obj_value=-499.7182085646996
w=[2.37592009e-01 2.87129232e-01 6.04080324e-03 7.75883776e-02
 3.61987200e-01 2.96623648e-02 9.26882798e-07 3.45620956e-11]
obj_value=-503.1400497681835
w=[2.37806051e-01 2.87387902e-01 6.04624001e-03 7.73919299e-02
 3.61678750e-01 2.96890822e-02 9.27717828e-07 3.45932326e-11]
obj_value=-503.1739496090684
w=[2.37827455e-01 2.87413769e-01 6.04678368e-03 7.73722851e-02
 3.61647905e-01 2.96917539e-02 9.27801331e-07 3.45963463e-11]
obj_value=-503.17423203194477
w=[2.37827470e-01 2.87413769e-01 6.04678368e-03 7.73722851e-02
 3.61647905e-01 2.96917539e-02 9.27801331e-07 3.45963463e-11]
obj_value=-503.17422453632247
w=[2.37827455e-01 2.87413784e-01 6.04678368e-03 7.73722851e-02
 3.61647905e-01 2.96917539e-02 9.27801331e-07 3.45963463e-11]
obj_value=-503.1742245315565
w=[2.37827455e-01 2.87413769e-01 6.04679858e-03 7.73722851e-02
 3.61647905e-01 2.96917539e-02 9.27801331e-07 3.45963463e-11]
obj_value=-503.17422452409653
w=[2.37827455e-01 2.87413769e-01 6.04678368e-03 7.73723000e-02
 3.61647905e-01 2.96917539e-02 9.27801331e-07 3.45963463e-11]
obj_value=-503.17422453213624
w=[2.37827455e-01 2.87413769e-01 6.04678368e-03 7.73722851e-02
 3.61647920e-01 2.96917539e-02 9.27801331e-07 3.45963463e-11]
obj_value=-503.1742245352709
w=[2.37827455e-01 2.87413769e-01 6.04678368e-03 7.73722851e-02
 3.61647905e-01 2.96917688e-02 9.27801331e-07 3.45963463e-11]
obj_value=-503.17422453475757
w=[2.37827455e-01 2.87413769e-01 6.04678368e-03 7.73722851e-02
 3.61647905e-01 2.96917539e-02 9.42702492e-07 3.45963463e-11]
obj_value=-503.1741513451186
w=[2.37827455e-01 2.87413769e-01 6.04678368e-03 7.73722851e-02
 3.61647905e-01 2.96917539e-02 9.27801331e-07 1.49357575e-08]
obj_value=-503.1742084590056
w=[3.21808264e-01 1.30404335e-02 2.63961552e-06 2.68847542e-02
 5.71174221e-01 6.71062858e-02 0.00000000e+00 0.00000000e+00]
obj_value=-348.35822632423805
w=[2.46225536e-01 2.59976435e-01 5.44236928e-03 7.23235320e-02
 3.82600537e-01 3.34332071e-02 8.35021198e-07 3.11367117e-11]
obj_value=-500.4418431824252
w=[2.38667263e-01 2.84670036e-01 5.98634224e-03 7.68674098e-02
 3.63743168e-01 3.00658993e-02 9.18523318e-07 3.42503829e-11]
obj_value=-503.14687171321907
w=[2.37911436e-01 2.87139396e-01 6.04073954e-03 7.73217976e-02
 3.61857432e-01 2.97291685e-02 9.26873530e-07 3.45617500e-11]
obj_value=-503.1740342948165
w=[2.37839763e-01 2.87373556e-01 6.04589784e-03 7.73648856e-02
 3.61678614e-01 2.96972375e-02 9.27665351e-07 3.45912758e-11]
obj_value=-503.1742384222887
w=[2.37839778e-01 2.87373556e-01 6.04589784e-03 7.73648856e-02
 3.61678614e-01 2.96972375e-02 9.27665351e-07 3.45912758e-11]
obj_value=-503.17423092456784
w=[2.37839763e-01 2.87373571e-01 6.04589784e-03 7.73648856e-02
 3.61678614e-01 2.96972375e-02 9.27665351e-07 3.45912758e-11]
obj_value=-503.17423092430346
w=[2.37839763e-01 2.87373556e-01 6.04591275e-03 7.73648856e-02
 3.61678614e-01 2.96972375e-02 9.27665351e-07 3.45912758e-11]
obj_value=-503.17423092061335
w=[2.37839763e-01 2.87373556e-01 6.04589784e-03 7.73649005e-02
 3.61678614e-01 2.96972375e-02 9.27665351e-07 3.45912758e-11]
obj_value=-503.1742309241714
w=[2.37839763e-01 2.87373556e-01 6.04589784e-03 7.73648856e-02
 3.61678629e-01 2.96972375e-02 9.27665351e-07 3.45912758e-11]
obj_value=-503.17423092489895
w=[2.37839763e-01 2.87373556e-01 6.04589784e-03 7.73648856e-02
 3.61678614e-01 2.96972524e-02 9.27665351e-07 3.45912758e-11]
obj_value=-503.1742309216975
w=[2.37839763e-01 2.87373556e-01 6.04589784e-03 7.73648856e-02
 3.61678614e-01 2.96972375e-02 9.42566512e-07 3.45912758e-11]
obj_value=-503.17415774694757
w=[2.37839763e-01 2.87373556e-01 6.04589784e-03 7.73648856e-02
 3.61678614e-01 2.96972375e-02 9.27665351e-07 1.49357525e-08]
obj_value=-503.1742148545717
w=[2.45756086e-01 2.83620198e-01 3.84893641e-06 7.09830587e-02
 3.99658523e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00]
obj_value=-468.35662984185086
w=[2.38631396e-01 2.86998221e-01 5.44169295e-03 7.67267029e-02
 3.65476605e-01 2.67275137e-02 8.34898816e-07 3.11321483e-11]
obj_value=-502.8000174956026
w=[2.37918926e-01 2.87336023e-01 5.98547736e-03 7.73010673e-02
 3.62058413e-01 2.94002651e-02 9.18388697e-07 3.42453631e-11]
obj_value=-503.1705151223566
w=[2.37847680e-01 2.87369803e-01 6.03985580e-03 7.73585038e-02
 3.61716594e-01 2.96675402e-02 9.26737686e-07 3.45566846e-11]
obj_value=-503.1742034215108
w=[2.37840555e-01 2.87373181e-01 6.04529364e-03 7.73642474e-02
 3.61682412e-01 2.96942677e-02 9.27572584e-07 3.45878167e-11]
obj_value=-503.1742382955961
w=[2.37839842e-01 2.87373519e-01 6.04583742e-03 7.73648218e-02
 3.61678994e-01 2.96969405e-02 9.27656074e-07 3.45909299e-11]
obj_value=-503.1742384433538
w=[2.37839773e-01 2.87373552e-01 6.04589003e-03 7.73648773e-02
 3.61678663e-01 2.96971991e-02 9.27664152e-07 3.45912311e-11]
obj_value=-503.1742384254319
w=[2.37839765e-01 2.87373556e-01 6.04589680e-03 7.73648845e-02
 3.61678620e-01 2.96972324e-02 9.27665191e-07 3.45912699e-11]
obj_value=-503.17423842271387
w=[2.37839763e-01 2.87373556e-01 6.04589771e-03 7.73648854e-02
 3.61678615e-01 2.96972368e-02 9.27665330e-07 3.45912751e-11]
obj_value=-503.17423842234484
w=[2.37839763e-01 2.87373556e-01 6.04589783e-03 7.73648856e-02
 3.61678614e-01 2.96972374e-02 9.27665348e-07 3.45912757e-11]
obj_value=-503.1742384222966
w=[2.37839763e-01 2.87373556e-01 6.04589784e-03 7.73648856e-02
 3.61678614e-01 2.96972375e-02 9.27665351e-07 3.45912758e-11]
obj_value=-503.1742384222915
_make_output_weights = OrderedDict([('BX4.PA', 0.23783976322549955), ('OBLI.PA', 0.28737355643971596), ('LQQ.PA', 0.006045897841581292), ('STZ.PA', 0.07736488558705952), ('CAC.PA', 0.3616786137913317), ('SAN.PA', 0.029697237460706617), ('AETH.PA', 9.276653505961068e-07), ('ABTC.PA', 3.459127583468283e-11)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('BX4.PA', 0.23784), ('OBLI.PA', 0.28737), ('LQQ.PA', 0.00605), ('STZ.PA', 0.07736), ('CAC.PA', 0.36168), ('SAN.PA', 0.0297), ('AETH.PA', 0.0), ('ABTC.PA', 0.0)]), 'expected_return': 0.037522392216383336, 'volatility': 0.016853512276973404, 'sharpe_ratio': 1.0396878661502391}
--- 0.8987891674041748 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['BX4.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned             date    open    high  ...  volume     code  converted_date
0     2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1     2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2     2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3     2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4     2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
...          ...     ...     ...  ...     ...      ...             ...
1057  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
1058  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
1059  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
1060  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
1061  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[1062 rows x 9 columns]
Getting data --- 0.42257094383239746 seconds ---
--- end init 0.49654388427734375 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['BX4.PA_adjusted_close', 'date_x', 'BX4.PA_return', 'BX4.PA_weight',
       'BX4.PA_nb_shares', 'BX4.PA_value', 'OBLI.PA_adjusted_close', 'date_y',
       'OBLI.PA_return', 'OBLI.PA_weight', 'OBLI.PA_nb_shares',
       'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_x', 'LQQ.PA_return',
       'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_y', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_x',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_y', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_x',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date_y', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            BX4.PA_adjusted_close     date_x  ...  portfolio_value  portfolio_return
date                                          ...                                   
2021-06-06                 1.5574 2021-06-04  ...      9996.079406         -0.000004
2021-06-13                 1.5134 2021-06-11  ...     10007.755200          0.001450
2021-06-20                 1.5248 2021-06-18  ...      9981.878944         -0.002560
2021-06-27                 1.4926 2021-06-25  ...      9955.468403         -0.001264
2021-07-04                 1.5238 2021-07-02  ...      9981.229233          0.002349
2021-07-11                 1.5268 2021-07-09  ...      9987.146297          0.000139
2021-07-18                 1.5616 2021-07-16  ...     10019.695309          0.002100
2021-07-25                 1.5032 2021-07-23  ...     10029.690620          0.001043
2021-08-01                 1.4818 2021-07-30  ...     10012.784122         -0.000880
2021-08-08                 1.3914 2021-08-06  ...     10015.543819          0.001556
2021-08-15                 1.3606 2021-08-13  ...     10007.270800          0.000658
2021-08-22                 1.4678 2021-08-20  ...     10045.215329          0.006391
2021-08-29                 1.4426 2021-08-27  ...     10012.057222         -0.002967
2021-09-05                 1.4368 2021-09-03  ...      9983.001334         -0.002501
2021-09-12                 1.4500 2021-09-10  ...      9942.900172         -0.002533
2021-09-19                 1.4884 2021-09-17  ...      9940.109293          0.000709
2021-09-26                 1.4506 2021-09-24  ...      9897.799814         -0.002885
2021-10-03                 1.4974 2021-10-01  ...      9904.734245          0.001772
2021-10-10                 1.4744 2021-10-08  ...      9903.739382          0.001122
2021-10-17                 1.3998 2021-10-15  ...      9906.364270          0.000532
2021-10-24                 1.3954 2021-10-22  ...      9916.059385         -0.000498
2021-10-31                 1.3548 2021-10-29  ...      9902.932294          0.000194
2021-11-07                 1.2740 2021-11-05  ...      9932.450751          0.003730

[23 rows x 50 columns]
--- 0.5605759620666504 seconds ---
127.0.0.1 - - [13/Nov/2021 08:17:47] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044}
--- 0.9529008865356445 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.4998610019683838 seconds ---
--- end init 0.5593080520629883 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.61667799949646 seconds ---
127.0.0.1 - - [13/Nov/2021 08:18:27] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 08:18:27] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:18:27] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:18:27] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:18:27] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:18:27] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:18:27] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044}
--- 0.9999752044677734 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.450808048248291 seconds ---
--- end init 0.518021821975708 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.5762848854064941 seconds ---
127.0.0.1 - - [13/Nov/2021 08:21:06] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 08:21:06] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:21:06] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:21:06] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:21:06] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:21:06] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 08:21:06] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044}
--- 0.9470667839050293 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.2714860439300537 seconds ---
--- end init 0.3249399662017822 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.3829808235168457 seconds ---
127.0.0.1 - - [13/Nov/2021 08:22:09] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044}
--- 0.7579491138458252 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.28919100761413574 seconds ---
--- end init 0.340756893157959 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.4084289073944092 seconds ---
127.0.0.1 - - [13/Nov/2021 08:55:14] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044}
--- 0.9531078338623047 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.2606227397918701 seconds ---
--- end init 0.31260085105895996 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.37235569953918457 seconds ---
127.0.0.1 - - [13/Nov/2021 08:57:25] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/simulation.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044}
--- 0.7992651462554932 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.3129251003265381 seconds ---
--- end init 0.38858795166015625 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.46602702140808105 seconds ---
127.0.0.1 - - [13/Nov/2021 08:57:51] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044}
--- 0.6627001762390137 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.2626152038574219 seconds ---
--- end init 0.30965518951416016 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.3657352924346924 seconds ---
127.0.0.1 - - [13/Nov/2021 08:58:29] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 09:10:15] "[31m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 400 -
127.0.0.1 - - [13/Nov/2021 09:10:23] "[31m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 400 -
127.0.0.1 - - [13/Nov/2021 09:10:30] "[31m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 400 -
127.0.0.1 - - [13/Nov/2021 09:10:50] "[31m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 400 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044}
--- 0.9697532653808594 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.33456897735595703 seconds ---
--- end init 0.39126086235046387 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.4473700523376465 seconds ---
127.0.0.1 - - [13/Nov/2021 09:11:37] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044}
--- 0.6153368949890137 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.264193058013916 seconds ---
--- end init 0.3118410110473633 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.36771607398986816 seconds ---
127.0.0.1 - - [13/Nov/2021 09:11:54] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
127.0.0.1 - - [13/Nov/2021 12:28:13] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 12:28:15] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:28:15] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:28:15] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:28:15] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:28:15] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/referencial.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/referencial.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/referencial.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/referencial.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
127.0.0.1 - - [13/Nov/2021 12:30:32] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 12:30:32] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:30:32] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:30:32] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:30:33] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:30:33] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 20 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
127.0.0.1 - - [13/Nov/2021 12:31:31] "[35m[1mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 500 -
127.0.0.1 - - [13/Nov/2021 12:31:32] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:31:32] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:31:32] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:31:32] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [13/Nov/2021 12:31:32] "[37mGET /api/v1/maximum_diversificaton?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/referencial.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/referencial.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/referencial.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/referencial.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/referencial.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 21 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044, 'asset_type_weights': {'Equity': 0.13529999999999998, 'Fixed Income': 0.8567, 'Crypto': 0.00799}}
--- 0.9932777881622314 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.39828991889953613 seconds ---
--- end init 0.46888089179992676 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.5279419422149658 seconds ---
127.0.0.1 - - [13/Nov/2021 12:34:31] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 21 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044, 'asset_type_weights': {'Equity': 0.13529999999999998, 'Fixed Income': 0.8567, 'Crypto': 0.00799}}
--- 0.6903760433197021 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.2736067771911621 seconds ---
--- end init 0.3215498924255371 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.37700891494750977 seconds ---
127.0.0.1 - - [13/Nov/2021 12:36:27] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 2}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
NumExpr defaulting to 8 threads.
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            1
1  FR0000120578  SAN  ...          BBB            1

[2 rows x 21 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date   open   high  ...   volume    code  converted_date
0    2021-04-27  61.85  61.96  ...    15259  CAC.PA    1.619474e+09
1    2021-04-28  62.07  62.33  ...    42911  CAC.PA    1.619561e+09
2    2021-04-29  62.49  62.63  ...   421296  CAC.PA    1.619647e+09
3    2021-04-30  62.28  62.34  ...    38586  CAC.PA    1.619734e+09
4    2021-05-03  61.99  62.27  ...    23231  CAC.PA    1.619993e+09
..          ...    ...    ...  ...      ...     ...             ...
273  2021-11-01  88.24  88.60  ...  1860698  SAN.PA    1.635721e+09
274  2021-11-02  88.50  89.92  ...  2156554  SAN.PA    1.635808e+09
275  2021-11-03  89.44  90.71  ...  2312650  SAN.PA    1.635894e+09
276  2021-11-04  90.40  91.00  ...  2062897  SAN.PA    1.635980e+09
277  2021-11-05  90.19  90.77  ...  2105657  SAN.PA    1.636067e+09

[278 rows x 9 columns]
127.0.0.1 - - [13/Nov/2021 13:04:32] "[37mGET /api/v1/stock_prices/CAC.PA,SAN.PA?lastpriceonly=0&candle=0 HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 561}], 'data': [{'_id': ObjectId('611429d9c889609c9144704c'), 'Code': 'INPHI', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'PHILIPS BUY BACK', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'NL0000009322', 'Type': 'Common Stock', 'AssetType': 'Equity'}, {'_id': ObjectId('6186a03dc2785d1035dc0997'), 'AssetType': 'Equity', 'Code': '', 'Country': 'France', 'Exchange': 'NYSE', 'General': {'Type': 'Common Stock', 'Name': 'PanAmSat Holding CORP', 'Exchange': 'NYSE', 'CurrencyCode': 'USD', 'LogoURL': ''}, 'ISIN': 'LU1861136247', 'Type': 'ETF'}, {'_id': ObjectId('6186a076c2785d1035dcc328'), 'AssetType': 'Fixed Income', 'Code': 'LQDA', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'iShares $ Corp Bond ETF USD Dist', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032895942', 'Type': 'ETF'}, {'_id': ObjectId('6186a08cc2785d1035dd047b'), 'AssetType': 'Fixed Income', 'Code': 'BUNS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor Bund Daily Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0530119774', 'Type': 'ETF'}, {'_id': ObjectId('6186a097c2785d1035dd2282'), 'AssetType': 'Fixed Income', 'Code': 'UEFR', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'UBS ETF - Markit iBoxx â‚¬ Liquid Corporates UCITS ETF (EUR) A-dis EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0721553864', 'Type': 'ETF'}, {'_id': ObjectId('6186a11bc2785d1035deb955'), 'AssetType': 'Equity', 'Code': 'PHAU', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'WisdomTree Physical Gold EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3770', 'Type': 'ETC'}, {'_id': ObjectId('6186a148c2785d1035df286a'), 'AssetType': 'Equity', 'Code': 'EQQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Invesco EQQQ NASDAQ-100 UCITS ETF EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032077012', 'Type': 'ETF'}, {'_id': ObjectId('6186a174c2785d1035dfaf0a'), 'AssetType': 'Equity', 'Code': 'VNRT', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Vanguard FTSE North America UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'USD'}, 'ISIN': 'IE00BKX55R35', 'Type': 'ETF'}, {'_id': ObjectId('6186a183c2785d1035dfd99c'), 'AssetType': 'Equity', 'Code': 'MWRD', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amundi MSCI World UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU1437016972', 'Type': 'ETF'}, {'_id': ObjectId('6186a18cc2785d1035dfef6b'), 'AssetType': 'Equity', 'Code': 'PHAG', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'ETFS Physical Silver ETC EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3333', 'Type': 'ETC'}]} 
Query itx = {'_id': ObjectId('611429d9c889609c9144704c'), 'Code': 'INPHI', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'PHILIPS BUY BACK', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'NL0000009322', 'Type': 'Common Stock', 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a03dc2785d1035dc0997'), 'AssetType': 'Equity', 'Code': '', 'Country': 'France', 'Exchange': 'NYSE', 'General': {'Type': 'Common Stock', 'Name': 'PanAmSat Holding CORP', 'Exchange': 'NYSE', 'CurrencyCode': 'USD', 'LogoURL': ''}, 'ISIN': 'LU1861136247', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a076c2785d1035dcc328'), 'AssetType': 'Fixed Income', 'Code': 'LQDA', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'iShares $ Corp Bond ETF USD Dist', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032895942', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a08cc2785d1035dd047b'), 'AssetType': 'Fixed Income', 'Code': 'BUNS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor Bund Daily Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0530119774', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a097c2785d1035dd2282'), 'AssetType': 'Fixed Income', 'Code': 'UEFR', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'UBS ETF - Markit iBoxx â‚¬ Liquid Corporates UCITS ETF (EUR) A-dis EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0721553864', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a11bc2785d1035deb955'), 'AssetType': 'Equity', 'Code': 'PHAU', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'WisdomTree Physical Gold EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3770', 'Type': 'ETC'}
Query itx = {'_id': ObjectId('6186a148c2785d1035df286a'), 'AssetType': 'Equity', 'Code': 'EQQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Invesco EQQQ NASDAQ-100 UCITS ETF EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032077012', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a174c2785d1035dfaf0a'), 'AssetType': 'Equity', 'Code': 'VNRT', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Vanguard FTSE North America UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'USD'}, 'ISIN': 'IE00BKX55R35', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a183c2785d1035dfd99c'), 'AssetType': 'Equity', 'Code': 'MWRD', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amundi MSCI World UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU1437016972', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a18cc2785d1035dfef6b'), 'AssetType': 'Equity', 'Code': 'PHAG', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'ETFS Physical Silver ETC EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3333', 'Type': 'ETC'}
df  result            ISIN   Code  ... EsgScoreNote total_stocks
0  NL0000009322  INPHI  ...          BBB          560
1  LU1861136247         ...          BBB          560
2  IE0032895942   LQDA  ...          BBB          560
3  LU0530119774   BUNS  ...          BBB          560
4  LU0721553864   UEFR  ...          BBB          560
5  JE00B1VS3770   PHAU  ...          BBB          560
6  IE0032077012   EQQQ  ...          BBB          560
7  IE00BKX55R35   VNRT  ...          BBB          560
8  LU1437016972   MWRD  ...          BBB          560
9  JE00B1VS3333   PHAG  ...          BBB          560

[10 rows x 21 columns] 
127.0.0.1 - - [13/Nov/2021 13:04:40] "[37mGET /api/v1/stock_universe HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'ISIN': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'ISIN': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 561}], 'data': [{'_id': ObjectId('611429c0c889609c914466a8'), 'Code': 'GLPG', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'Galapagos NV', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/AS/GLPG.png'}, 'ISIN': 'BE0003818359', 'Type': 'Common Stock', 'last_price_volume': 511725, 'AssetType': 'Equity'}, {'_id': ObjectId('611429b7c889609c914462ff'), 'Code': 'FAGR', 'Country': 'Belgium', 'Exchange': 'BR', 'General': {'Type': 'Common Stock', 'Name': 'Fagron NV', 'Exchange': 'BR', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/BR/FAGR.png'}, 'ISIN': 'BE0003874915', 'Type': 'Common Stock', 'last_price_volume': 152247, 'AssetType': 'Equity'}, {'_id': ObjectId('613650e586ee1aff11ea3a1b'), 'Code': 'ALPHS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Pharmasimple SA', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/ALPHS.png'}, 'ISIN': 'BE0974302342', 'Type': 'Common Stock', 'last_price_volume': 305720, 'AssetType': 'Equity'}, {'_id': ObjectId('611428adc889609c9143f3f5'), 'Code': 'XFAB', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'X-FAB Silicon Foundries SE', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/XFAB.png'}, 'ISIN': 'BE0974310428', 'Type': 'Common Stock', 'last_price_volume': 191475, 'AssetType': 'Equity'}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}, {'_id': ObjectId('6186a062c2785d1035dc7cae'), 'AssetType': 'Fixed Income', 'Code': 'VBTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'VanEck Vectors Bitcoin ETN A EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'DE000A28M8D0', 'Type': 'ETN', 'last_price_volume': 3838}, {'_id': ObjectId('6186a06ec2785d1035dca7db'), 'AssetType': 'Fixed Income', 'Code': 'VETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'VanEck Vectors Ethereum ETN A EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'DE000A3GPSP7', 'Type': 'ETN', 'last_price_volume': 607}, {'_id': ObjectId('61142bf9c889609c914545d6'), 'Code': 'EDPR', 'Country': 'Portugal', 'Exchange': 'LS', 'General': {'Type': 'Common Stock', 'Name': 'EDP RenovÃ¡veis S.A', 'Exchange': 'LS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'ES0127797019', 'Type': 'Common Stock', 'last_price_volume': 625499, 'AssetType': 'Equity'}, {'_id': ObjectId('61364ff686ee1aff11e5caee'), 'Code': 'AF', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Air France-KLM SA', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/AF.png'}, 'ISIN': 'FR0000031122', 'Type': 'Common Stock', 'last_price_volume': 10278791, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611429c0c889609c914466a8'), 'Code': 'GLPG', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'Galapagos NV', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/AS/GLPG.png'}, 'ISIN': 'BE0003818359', 'Type': 'Common Stock', 'last_price_volume': 511725, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611429b7c889609c914462ff'), 'Code': 'FAGR', 'Country': 'Belgium', 'Exchange': 'BR', 'General': {'Type': 'Common Stock', 'Name': 'Fagron NV', 'Exchange': 'BR', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/BR/FAGR.png'}, 'ISIN': 'BE0003874915', 'Type': 'Common Stock', 'last_price_volume': 152247, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('613650e586ee1aff11ea3a1b'), 'Code': 'ALPHS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Pharmasimple SA', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/ALPHS.png'}, 'ISIN': 'BE0974302342', 'Type': 'Common Stock', 'last_price_volume': 305720, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611428adc889609c9143f3f5'), 'Code': 'XFAB', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'X-FAB Silicon Foundries SE', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/XFAB.png'}, 'ISIN': 'BE0974310428', 'Type': 'Common Stock', 'last_price_volume': 191475, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
Query itx = {'_id': ObjectId('6186a062c2785d1035dc7cae'), 'AssetType': 'Fixed Income', 'Code': 'VBTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'VanEck Vectors Bitcoin ETN A EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'DE000A28M8D0', 'Type': 'ETN', 'last_price_volume': 3838}
Query itx = {'_id': ObjectId('6186a06ec2785d1035dca7db'), 'AssetType': 'Fixed Income', 'Code': 'VETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'VanEck Vectors Ethereum ETN A EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'DE000A3GPSP7', 'Type': 'ETN', 'last_price_volume': 607}
Query itx = {'_id': ObjectId('61142bf9c889609c914545d6'), 'Code': 'EDPR', 'Country': 'Portugal', 'Exchange': 'LS', 'General': {'Type': 'Common Stock', 'Name': 'EDP RenovÃ¡veis S.A', 'Exchange': 'LS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'ES0127797019', 'Type': 'Common Stock', 'last_price_volume': 625499, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('61364ff686ee1aff11e5caee'), 'Code': 'AF', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Air France-KLM SA', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/AF.png'}, 'ISIN': 'FR0000031122', 'Type': 'Common Stock', 'last_price_volume': 10278791, 'AssetType': 'Equity'}
df  result            ISIN   Code  ... EsgScoreNote total_stocks
0  BE0003818359   GLPG  ...          BBB          560
1  BE0003874915   FAGR  ...          BBB          560
2  BE0974302342  ALPHS  ...          BBB          560
3  BE0974310428   XFAB  ...          BBB          560
4  CH0454664001   ABTC  ...          BBB          560
5  CH0454664027   AETH  ...          BBB          560
6  DE000A28M8D0   VBTC  ...          BBB          560
7  DE000A3GPSP7   VETH  ...          BBB          560
8  ES0127797019   EDPR  ...          BBB          560
9  FR0000031122     AF  ...          BBB          560

[10 rows x 21 columns] 
127.0.0.1 - - [13/Nov/2021 13:04:47] "[37mGET /api/v1/stock_universe?order_type=ISIN HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 21 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044, 'asset_type_weights': {'Equity': 0.13529999999999998, 'Fixed Income': 0.8567, 'Crypto': 0.00799}}
--- 0.9976649284362793 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.2772066593170166 seconds ---
--- end init 0.3379638195037842 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.39731478691101074 seconds ---
127.0.0.1 - - [13/Nov/2021 13:47:21] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 21 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044, 'asset_type_weights': {'Equity': 0.13529999999999998, 'Fixed Income': 0.8567, 'Crypto': 0.00799}}
--- 0.650554895401001 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.2740142345428467 seconds ---
--- end init 0.3295440673828125 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.38811516761779785 seconds ---
127.0.0.1 - - [13/Nov/2021 13:47:33] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/analytics/analytics.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 7}], 'data': [{'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}, {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}]} 
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0000120578   SAN  ...          BBB            6
1  FR0007052782   CAC  ...          BBB            6
2  FR0013346681  OBLI  ...          BBB            6
3  CH0454664001  ABTC  ...          BBB            6
4  IE00BKWQ0G16   STZ  ...          BBB            6
5  FR0010342592   LQQ  ...          BBB            6
6  CH0454664027  AETH  ...          BBB            6

[7 rows x 21 columns] 
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['SAN.PA', 'CAC.PA', 'OBLI.PA', 'ABTC.PA', 'STZ.PA', 'LQQ.PA', 'AETH.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}, 'code': 1}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
 max_diversification cov =           OBLI.PA    LQQ.PA    STZ.PA    CAC.PA    SAN.PA   AETH.PA   ABTC.PA
OBLI.PA  0.001150  0.001848 -0.001038  0.000193  0.000580  0.002834 -0.000208
LQQ.PA   0.001848  0.069338  0.020843  0.021603  0.007925  0.056865  0.039021
STZ.PA  -0.001038  0.020843  0.028336  0.018931  0.005417  0.041665  0.032170
CAC.PA   0.000193  0.021603  0.018931  0.019394  0.006178  0.028898  0.015571
SAN.PA   0.000580  0.007925  0.005417  0.006178  0.021353  0.018108  0.018430
AETH.PA  0.002834  0.056865  0.041665  0.028898  0.018108  0.735727  0.519757
ABTC.PA -0.000208  0.039021  0.032170  0.015571  0.018430  0.519757  0.548408
 df_full  =             OBLI.PA  LQQ.PA  STZ.PA   CAC.PA  SAN.PA  AETH.PA  ABTC.PA
2021-06-01   10.790   616.3   58.36  63.6755   85.86   23.666   10.545
2021-06-02   10.798   621.8   58.52  64.0097   85.51   25.805   11.109
2021-06-03   10.790   613.1   58.61  63.8720   85.48   26.178   11.343
2021-06-04   10.812   629.0   58.34  63.9900   86.08   24.623   10.776
2021-06-07   10.792   625.2   58.57  64.2652   86.18   25.829   10.534
...             ...     ...     ...      ...     ...      ...      ...
2021-11-01   10.756   873.4   63.17  67.8700   88.30   42.102   18.700
2021-11-02   10.826   882.3   63.04  68.2100   89.61   43.620   19.517
2021-11-03   10.834   887.9   63.17  68.4500   90.24   44.065   19.035
2021-11-04   10.876   925.2   62.52  68.7800   89.69   43.495   18.724
2021-11-05   10.922   938.3   62.93  69.3100   88.46   43.635   18.664

[114 rows x 7 columns]
expected_returns [0.0242186  1.65206843 0.24359132 0.24348092 0.09522748 5.38559083
 3.90701991]
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060254551156
w=[0.14285716 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706031481694
w=[0.14285714 0.14285716 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.2457060108802205
w=[0.14285714 0.14285714 0.14285716 0.14285714 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706013583016
w=[0.14285714 0.14285714 0.14285714 0.14285716 0.14285714 0.14285714
 0.14285714]
obj_value=-5.245706019224364
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285716 0.14285714
 0.14285714]
obj_value=-5.245706032263852
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285716
 0.14285714]
obj_value=-5.245705735172218
w=[0.14285714 0.14285714 0.14285714 0.14285714 0.14285714 0.14285714
 0.14285716]
obj_value=-5.245705788410682
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597709549119
w=[4.73755136e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597731331167
w=[4.73755121e-01 1.49011612e-08 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597981940316
w=[4.73755121e-01 0.00000000e+00 1.49011612e-08 0.00000000e+00
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597941230943
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 1.49011612e-08
 5.26244879e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597808896101
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244894e-01 1.12970744e-12 8.27726776e-13]
obj_value=-14.388597282511867
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.49022909e-08 8.27726776e-13]
obj_value=-14.388598966244677
w=[4.73755121e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 5.26244879e-01 1.12970744e-12 1.49019889e-08]
obj_value=-14.388598780342882
w=[1.14908083e-14 6.99393047e-01 2.74528545e-01 0.00000000e+00
 3.49720253e-14 1.30728761e-14 2.60784078e-02]
obj_value=-5.39130675534334
w=[2.87246356e-01 2.75338308e-01 1.08076889e-01 0.00000000e+00
 3.19071852e-01 6.90108743e-13 1.02665943e-02]
obj_value=-13.256896508163116
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885747346415
w=[3.87908095e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885756039447
w=[3.87908080e-01 1.26733893e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885298920006
w=[3.87908080e-01 1.26733879e-01 4.97461017e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885665296986
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 1.49011612e-08
 4.30886404e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.935885579822127
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886418e-01 9.27367096e-13 4.72555136e-03]
obj_value=-16.93588529144112
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 1.49020886e-08 4.72555136e-03]
obj_value=-16.935886077383785
w=[3.87908080e-01 1.26733879e-01 4.97460868e-02 0.00000000e+00
 4.30886404e-01 9.27367096e-13 4.72556626e-03]
obj_value=-16.935886090033804
w=[7.72717718e-01 8.26616553e-13 0.00000000e+00 5.76302894e-13
 9.82047776e-13 0.00000000e+00 2.27282282e-01]
obj_value=-6.7206203397114335
w=[5.20442773e-01 8.30846712e-02 3.26127261e-02 1.98488082e-13
 2.82482124e-01 6.07966797e-13 8.13777064e-02]
obj_value=-17.1131135289162
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163598971888
w=[4.55718474e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635991547034
w=[4.55718459e-01 1.04401104e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.961635469348945
w=[4.55718459e-01 1.04401090e-01 4.09799465e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163584909978
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.49012627e-08
 3.54956469e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.9616358042381
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956484e-01 7.63948333e-13 4.39440505e-02]
obj_value=-18.96163552280538
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 1.49019251e-08 4.39440505e-02]
obj_value=-18.96163474575701
w=[4.55718459e-01 1.04401090e-01 4.09799316e-02 1.01554936e-13
 3.54956469e-01 7.63948333e-13 4.39440654e-02]
obj_value=-18.961634679875882
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340997684745
w=[8.81885697e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634065214176
w=[8.81885682e-01 1.49026259e-08 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.936340014668424
w=[8.81885682e-01 1.46467560e-12 9.24071934e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634064500496
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 1.49011612e-08
 1.85657045e-11 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634047248639
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.49197269e-08 2.57071394e-02 0.00000000e+00]
obj_value=-37.93634128234083
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071543e-02 0.00000000e+00]
obj_value=-37.93633212948756
w=[8.81885682e-01 1.46467560e-12 9.24071785e-02 0.00000000e+00
 1.85657045e-11 2.57071394e-02 1.49011612e-08]
obj_value=-37.93633693745873
w=[9.26031266e-01 0.00000000e+00 9.65905550e-11 2.16314154e-11
 7.39687338e-02 0.00000000e+00 5.32455208e-11]
obj_value=-35.7024620961235
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140139364644
w=[9.01506517e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214007344479
w=[9.01506502e-01 1.49019749e-08 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140059681894
w=[9.01506502e-01 8.13690078e-13 5.13361634e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140203659181
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 1.49107754e-08
 3.28759317e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.62140122727623
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759466e-02 1.42814178e-02 2.36653517e-11]
obj_value=-43.6214013059914
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814327e-02 2.36653517e-11]
obj_value=-43.62139538146761
w=[9.01506502e-01 8.13690078e-13 5.13361485e-02 9.61423696e-12
 3.28759317e-02 1.42814178e-02 1.49248265e-08]
obj_value=-43.62140038107999
w=[1.81897974e-09 0.00000000e+00 1.63156518e-01 3.77965142e-10
 8.36843481e-01 0.00000000e+00 2.97605722e-10]
obj_value=-8.712790370785164
w=[6.45864638e-01 5.82950479e-13 8.30452574e-02 1.14068184e-10
 2.60858495e-01 1.02316098e-02 1.01347129e-10]
obj_value=-30.332879726835934
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509886677753
w=[8.38370926e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509830111876
w=[8.38370911e-01 1.49019179e-08 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509768687379
w=[8.38370911e-01 7.56704572e-13 5.91673273e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509892200661
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 1.49365723e-08
 8.91805355e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.25509826928244
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805504e-02 1.32812412e-02 4.28503351e-11]
obj_value=-44.255097657864575
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812561e-02 4.28503351e-11]
obj_value=-44.25509279228449
w=[8.38370911e-01 7.56704572e-13 5.91673124e-02 3.54111137e-11
 8.91805355e-02 1.32812412e-02 1.49440115e-08]
obj_value=-44.25509709271802
w=[8.31283924e-01 1.40274381e-09 1.63971023e-01 0.00000000e+00
 4.74505170e-03 1.45760583e-09 0.00000000e+00]
obj_value=-43.89653193564421
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684587613332
w=[8.34923107e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836845261501004
w=[8.34923092e-01 1.55839847e-08 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.836843757211035
w=[8.34923092e-01 6.82823507e-10 1.10154338e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684468916629
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.49193448e-08
 4.81026682e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684440918418
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026831e-02 6.81991734e-03 2.20036448e-11]
obj_value=-47.83684507166076
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81993224e-03 2.20036448e-11]
obj_value=-47.83684144689161
w=[8.34923092e-01 6.82823507e-10 1.10154323e-01 1.81836050e-11
 4.81026682e-02 6.81991734e-03 1.49231648e-08]
obj_value=-47.83684580641735
w=[8.59726257e-01 1.19142031e-09 1.05941247e-01 0.00000000e+00
 0.00000000e+00 1.03244163e-09 3.43324941e-02]
obj_value=-39.20828933361332
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023181222147535
w=[8.38698200e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318062421475
w=[8.38698186e-01 1.56613942e-08 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179051920174
w=[8.38698186e-01 7.60233009e-10 1.09513099e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.023179985405015
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.49165772e-08
 4.07813410e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02317978959879
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813559e-02 5.78191176e-03 5.22547773e-03]
obj_value=-48.02318051945218
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78192666e-03 5.22547773e-03]
obj_value=-48.023174848726775
w=[8.38698186e-01 7.60233009e-10 1.09513084e-01 1.54160221e-11
 4.07813410e-02 5.78191176e-03 5.22549264e-03]
obj_value=-48.02317870195929
w=[8.88439499e-01 8.17745511e-10 4.14281482e-02 0.00000000e+00
 6.08006321e-02 7.08083070e-10 9.33171946e-03]
obj_value=-46.45206579972805
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384425565935
w=[8.57121360e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843536589476
w=[8.57121346e-01 1.56826957e-08 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943842418336594
w=[8.57121346e-01 7.81534458e-10 8.42958382e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843756208146
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 1.49108674e-08
 4.81960749e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.943843221407725
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960898e-02 3.64041076e-03 6.74634526e-03]
obj_value=-48.94384342373682
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64042566e-03 6.74634526e-03]
obj_value=-48.94383907789195
w=[8.57121346e-01 7.81534458e-10 8.42958233e-02 9.70624444e-12
 4.81960749e-02 3.64041076e-03 6.74636016e-03]
obj_value=-48.94384248524987
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188237602023
w=[8.56748718e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881633560884
w=[8.56748703e-01 1.49011612e-08 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188033385495
w=[8.56748703e-01 0.00000000e+00 9.69504221e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.86188157035124
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 1.51112403e-08
 3.90764736e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881118362966
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764885e-02 0.00000000e+00 7.22441717e-03]
obj_value=-49.861881687107264
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 1.49011612e-08 7.22441717e-03]
obj_value=-49.86187931791294
w=[8.56748703e-01 0.00000000e+00 9.69504072e-02 2.10079125e-10
 3.90764736e-02 0.00000000e+00 7.22443207e-03]
obj_value=-49.861882117356544
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.8786736863377
w=[8.55883106e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867294563222
w=[8.55883091e-01 1.49011612e-08 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867167938411
w=[8.55883091e-01 0.00000000e+00 9.30306429e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867295921944
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 1.49087741e-08
 4.27346828e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867248663545
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346977e-02 0.00000000e+00 8.35159873e-03]
obj_value=-49.87867290436538
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 1.49011612e-08 8.35159873e-03]
obj_value=-49.878670027453744
w=[8.55883091e-01 0.00000000e+00 9.30306280e-02 7.61287974e-12
 4.27346828e-02 0.00000000e+00 8.35161363e-03]
obj_value=-49.878672700736836
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884183430416925
w=[8.56912854e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182686483406
w=[8.56912839e-01 1.49011612e-08 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418141816445
w=[8.56912839e-01 0.00000000e+00 9.39840269e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418269127781
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 1.49221436e-08
 4.10970727e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.88418222032778
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970876e-02 0.00000000e+00 8.00607622e-03]
obj_value=-49.884182690372384
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 1.49011612e-08 8.00607622e-03]
obj_value=-49.884179967658575
w=[8.56912839e-01 0.00000000e+00 9.39840120e-02 2.09823719e-11
 4.10970727e-02 0.00000000e+00 8.00609112e-03]
obj_value=-49.884182685329954
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88421049325418
w=[8.56623565e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420975016039
w=[8.56623550e-01 1.50708294e-08 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420847779868
w=[8.56623550e-01 1.69668231e-10 9.41337962e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974815306
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 1.49011612e-08
 4.12546405e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.884209279165944
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546554e-02 7.38207141e-11 7.98802827e-03]
obj_value=-49.88420974873827
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 1.49749819e-08 7.98802827e-03]
obj_value=-49.88420703345737
w=[8.56623550e-01 1.69668231e-10 9.41337813e-02 0.00000000e+00
 4.12546405e-02 7.38207141e-11 7.98804317e-03]
obj_value=-49.88420975125006
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421573898976
w=[8.56704842e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.88421499565658
w=[8.56704827e-01 1.52586280e-08 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884213724481924
w=[8.56704827e-01 3.57466831e-10 9.40876932e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995661004
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 1.49011612e-08
 4.12136431e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214526089025
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136580e-02 1.55406190e-10 7.99385113e-03]
obj_value=-49.884214995652684
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.50565674e-08 7.99385113e-03]
obj_value=-49.88421227800946
w=[8.56704827e-01 3.57466831e-10 9.40876783e-02 0.00000000e+00
 4.12136431e-02 1.55406190e-10 7.99386603e-03]
obj_value=-49.88421499567342
_make_output_weights = OrderedDict([('OBLI.PA', 0.8567048269981178), ('LQQ.PA', 3.574668306755805e-10), ('STZ.PA', 0.09408767830614394), ('CAC.PA', 0.0), ('SAN.PA', 0.041213643079932756), ('AETH.PA', 1.554061901443192e-10), ('ABTC.PA', 0.007993851130765716)])
opto from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done
{'weights': OrderedDict([('OBLI.PA', 0.8567), ('LQQ.PA', 0.0), ('STZ.PA', 0.09409), ('CAC.PA', 0.0), ('SAN.PA', 0.04121), ('AETH.PA', 0.0), ('ABTC.PA', 0.00799)]), 'expected_return': 0.07882393824440805, 'volatility': 0.03375205909127565, 'sharpe_ratio': 1.7428251735792044, 'asset_type_weights': {'Equity': 0.13529999999999998, 'Fixed Income': 0.8567, 'Crypto': 0.00799}}
--- 1.2382981777191162 seconds ---
dates sent from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
dates Computed from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'SAN.PA', 'AETH.PA', 'ABTC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1619474400.0]}, {'$lte': ['$$price.converted_date', 1636844400.0]}]}}}}}]: dates from 2021-04-27 00:00:00 to 2021-11-14 00:00:00
Data returned            date    open    high  ...  volume     code  converted_date
0    2021-06-01  10.840  10.840  ...    9879  ABTC.PA    1.622498e+09
1    2021-06-02  10.752  11.109  ...    3192  ABTC.PA    1.622585e+09
2    2021-06-03  11.359  11.524  ...   10825  ABTC.PA    1.622671e+09
3    2021-06-04  10.745  10.866  ...   11585  ABTC.PA    1.622758e+09
4    2021-06-07  10.574  10.625  ...     576  ABTC.PA    1.623017e+09
..          ...     ...     ...  ...     ...      ...             ...
918  2021-11-01  62.540  63.270  ...    4444   STZ.PA    1.635721e+09
919  2021-11-02  62.930  63.040  ...    3303   STZ.PA    1.635808e+09
920  2021-11-03  62.850  63.260  ...  297542   STZ.PA    1.635894e+09
921  2021-11-04  63.740  63.740  ...    6536   STZ.PA    1.635980e+09
922  2021-11-05  62.440  63.240  ...    5383   STZ.PA    1.636067e+09

[923 rows x 9 columns]
Getting data --- 0.26132702827453613 seconds ---
--- end init 0.3201010227203369 seconds ---
back_test_portfolio from 2021-04-27 00:00:00 to 2021-11-14 00:00:00 done, columns Index(['OBLI.PA_adjusted_close', 'date_x', 'OBLI.PA_return', 'OBLI.PA_weight',
       'OBLI.PA_nb_shares', 'OBLI.PA_value', 'LQQ.PA_adjusted_close', 'date_y',
       'LQQ.PA_return', 'LQQ.PA_weight', 'LQQ.PA_nb_shares', 'LQQ.PA_value',
       'STZ.PA_adjusted_close', 'date_x', 'STZ.PA_return', 'STZ.PA_weight',
       'STZ.PA_nb_shares', 'STZ.PA_value', 'CAC.PA_adjusted_close', 'date_y',
       'CAC.PA_return', 'CAC.PA_weight', 'CAC.PA_nb_shares', 'CAC.PA_value',
       'SAN.PA_adjusted_close', 'date_x', 'SAN.PA_return', 'SAN.PA_weight',
       'SAN.PA_nb_shares', 'SAN.PA_value', 'AETH.PA_adjusted_close', 'date_y',
       'AETH.PA_return', 'AETH.PA_weight', 'AETH.PA_nb_shares',
       'AETH.PA_value', 'ABTC.PA_adjusted_close', 'date', 'ABTC.PA_return',
       'ABTC.PA_weight', 'ABTC.PA_nb_shares', 'ABTC.PA_value',
       'portfolio_value', 'portfolio_return'],
      dtype='object')
            OBLI.PA_adjusted_close  ... portfolio_return
date                                ...                 
2021-06-06                  10.812  ...        -0.000305
2021-06-13                  10.868  ...         0.005364
2021-06-20                  10.822  ...        -0.005614
2021-06-27                  10.770  ...        -0.003474
2021-07-04                  10.854  ...         0.005145
2021-07-11                  10.898  ...         0.002818
2021-07-18                  10.958  ...         0.003349
2021-07-25                  11.024  ...         0.006854
2021-08-01                  11.030  ...         0.002154
2021-08-08                  11.054  ...         0.005571
2021-08-15                  11.056  ...         0.003278
2021-08-22                  11.074  ...         0.001111
2021-08-29                  10.998  ...        -0.006157
2021-09-05                  10.942  ...        -0.004657
2021-09-12                  10.932  ...        -0.005399
2021-09-19                  10.912  ...        -0.001037
2021-09-26                  10.862  ...        -0.004546
2021-10-03                  10.844  ...         0.000754
2021-10-10                  10.786  ...         0.001220
2021-10-17                  10.824  ...         0.005299
2021-10-24                  10.780  ...        -0.002193
2021-10-31                  10.774  ...         0.001490
2021-11-07                  10.922  ...         0.013275

[23 rows x 44 columns]
--- 0.38884925842285156 seconds ---
127.0.0.1 - - [13/Nov/2021 13:51:04] "[37mGET /api/v1/maximum_diversificaton HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'ISIN': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'ISIN': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 561}], 'data': [{'_id': ObjectId('611429c0c889609c914466a8'), 'Code': 'GLPG', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'Galapagos NV', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/AS/GLPG.png'}, 'ISIN': 'BE0003818359', 'Type': 'Common Stock', 'last_price_volume': 511725, 'AssetType': 'Equity'}, {'_id': ObjectId('611429b7c889609c914462ff'), 'Code': 'FAGR', 'Country': 'Belgium', 'Exchange': 'BR', 'General': {'Type': 'Common Stock', 'Name': 'Fagron NV', 'Exchange': 'BR', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/BR/FAGR.png'}, 'ISIN': 'BE0003874915', 'Type': 'Common Stock', 'last_price_volume': 152247, 'AssetType': 'Equity'}, {'_id': ObjectId('613650e586ee1aff11ea3a1b'), 'Code': 'ALPHS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Pharmasimple SA', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/ALPHS.png'}, 'ISIN': 'BE0974302342', 'Type': 'Common Stock', 'last_price_volume': 305720, 'AssetType': 'Equity'}, {'_id': ObjectId('611428adc889609c9143f3f5'), 'Code': 'XFAB', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'X-FAB Silicon Foundries SE', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/XFAB.png'}, 'ISIN': 'BE0974310428', 'Type': 'Common Stock', 'last_price_volume': 191475, 'AssetType': 'Equity'}, {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}, {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}, {'_id': ObjectId('6186a062c2785d1035dc7cae'), 'AssetType': 'Fixed Income', 'Code': 'VBTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'VanEck Vectors Bitcoin ETN A EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'DE000A28M8D0', 'Type': 'ETN', 'last_price_volume': 3838}, {'_id': ObjectId('6186a06ec2785d1035dca7db'), 'AssetType': 'Fixed Income', 'Code': 'VETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'VanEck Vectors Ethereum ETN A EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'DE000A3GPSP7', 'Type': 'ETN', 'last_price_volume': 607}, {'_id': ObjectId('61142bf9c889609c914545d6'), 'Code': 'EDPR', 'Country': 'Portugal', 'Exchange': 'LS', 'General': {'Type': 'Common Stock', 'Name': 'EDP RenovÃ¡veis S.A', 'Exchange': 'LS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'ES0127797019', 'Type': 'Common Stock', 'last_price_volume': 625499, 'AssetType': 'Equity'}, {'_id': ObjectId('61364ff686ee1aff11e5caee'), 'Code': 'AF', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Air France-KLM SA', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/AF.png'}, 'ISIN': 'FR0000031122', 'Type': 'Common Stock', 'last_price_volume': 10278791, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611429c0c889609c914466a8'), 'Code': 'GLPG', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'Galapagos NV', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/AS/GLPG.png'}, 'ISIN': 'BE0003818359', 'Type': 'Common Stock', 'last_price_volume': 511725, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611429b7c889609c914462ff'), 'Code': 'FAGR', 'Country': 'Belgium', 'Exchange': 'BR', 'General': {'Type': 'Common Stock', 'Name': 'Fagron NV', 'Exchange': 'BR', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/BR/FAGR.png'}, 'ISIN': 'BE0003874915', 'Type': 'Common Stock', 'last_price_volume': 152247, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('613650e586ee1aff11ea3a1b'), 'Code': 'ALPHS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Pharmasimple SA', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/ALPHS.png'}, 'ISIN': 'BE0974302342', 'Type': 'Common Stock', 'last_price_volume': 305720, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('611428adc889609c9143f3f5'), 'Code': 'XFAB', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'X-FAB Silicon Foundries SE', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/XFAB.png'}, 'ISIN': 'BE0974310428', 'Type': 'Common Stock', 'last_price_volume': 191475, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a0a3c2785d1035dd43f7'), 'AssetType': 'Crypto', 'Code': 'ABTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': '21Shares Bitcoin ETP EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664001', 'Type': 'ETN', 'last_price_volume': 7060}
Query itx = {'_id': ObjectId('6186a0a1c2785d1035dd3efe'), 'AssetType': 'Crypto', 'Code': 'AETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amun Coin Market Cap Fund', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'CH0454664027', 'Type': 'ETN', 'last_price_volume': 2263}
Query itx = {'_id': ObjectId('6186a062c2785d1035dc7cae'), 'AssetType': 'Fixed Income', 'Code': 'VBTC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'VanEck Vectors Bitcoin ETN A EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'DE000A28M8D0', 'Type': 'ETN', 'last_price_volume': 3838}
Query itx = {'_id': ObjectId('6186a06ec2785d1035dca7db'), 'AssetType': 'Fixed Income', 'Code': 'VETH', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'VanEck Vectors Ethereum ETN A EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'DE000A3GPSP7', 'Type': 'ETN', 'last_price_volume': 607}
Query itx = {'_id': ObjectId('61142bf9c889609c914545d6'), 'Code': 'EDPR', 'Country': 'Portugal', 'Exchange': 'LS', 'General': {'Type': 'Common Stock', 'Name': 'EDP RenovÃ¡veis S.A', 'Exchange': 'LS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'ES0127797019', 'Type': 'Common Stock', 'last_price_volume': 625499, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('61364ff686ee1aff11e5caee'), 'Code': 'AF', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Air France-KLM SA', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/AF.png'}, 'ISIN': 'FR0000031122', 'Type': 'Common Stock', 'last_price_volume': 10278791, 'AssetType': 'Equity'}
NumExpr defaulting to 8 threads.
df  result            ISIN   Code  ... EsgScoreNote total_stocks
0  BE0003818359   GLPG  ...          BBB          560
1  BE0003874915   FAGR  ...          BBB          560
2  BE0974302342  ALPHS  ...          BBB          560
3  BE0974310428   XFAB  ...          BBB          560
4  CH0454664001   ABTC  ...          BBB          560
5  CH0454664027   AETH  ...          BBB          560
6  DE000A28M8D0   VBTC  ...          BBB          560
7  DE000A3GPSP7   VETH  ...          BBB          560
8  ES0127797019   EDPR  ...          BBB          560
9  FR0000031122     AF  ...          BBB          560

[10 rows x 21 columns] 
127.0.0.1 - - [13/Nov/2021 15:50:00] "[37mGET /api/v1/stock_universe?order_type=ISIN HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 1}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            0

[1 rows x 21 columns] 
127.0.0.1 - - [13/Nov/2021 15:50:06] "[37mGET /api/v1/stock_universe?codes=CAC.PA HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 2}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            1
1  FR0000120578  SAN  ...          BBB            1

[2 rows x 21 columns] 
127.0.0.1 - - [13/Nov/2021 15:50:11] "[37mGET /api/v1/stock_universe?codes=CAC.PA,SAN.PA HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA', 'BX4.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA', 'BX4.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 3}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}, {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452, 'AssetType': 'Equity'}
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            2
1  FR0000120578  SAN  ...          BBB            2
2  FR0010411884  BX4  ...          BBB            2

[3 rows x 21 columns] 
127.0.0.1 - - [13/Nov/2021 15:50:20] "[37mGET /api/v1/stock_universe?codes=CAC.PA,SAN.PA,BX4.PA HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 561}], 'data': [{'_id': ObjectId('611429d9c889609c9144704c'), 'Code': 'INPHI', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'PHILIPS BUY BACK', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'NL0000009322', 'Type': 'Common Stock', 'AssetType': 'Equity'}, {'_id': ObjectId('6186a03dc2785d1035dc0997'), 'AssetType': 'Equity', 'Code': '', 'Country': 'France', 'Exchange': 'NYSE', 'General': {'Type': 'Common Stock', 'Name': 'PanAmSat Holding CORP', 'Exchange': 'NYSE', 'CurrencyCode': 'USD', 'LogoURL': ''}, 'ISIN': 'LU1861136247', 'Type': 'ETF'}, {'_id': ObjectId('6186a076c2785d1035dcc328'), 'AssetType': 'Fixed Income', 'Code': 'LQDA', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'iShares $ Corp Bond ETF USD Dist', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032895942', 'Type': 'ETF'}, {'_id': ObjectId('6186a08cc2785d1035dd047b'), 'AssetType': 'Fixed Income', 'Code': 'BUNS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor Bund Daily Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0530119774', 'Type': 'ETF'}, {'_id': ObjectId('6186a097c2785d1035dd2282'), 'AssetType': 'Fixed Income', 'Code': 'UEFR', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'UBS ETF - Markit iBoxx â‚¬ Liquid Corporates UCITS ETF (EUR) A-dis EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0721553864', 'Type': 'ETF'}, {'_id': ObjectId('6186a11bc2785d1035deb955'), 'AssetType': 'Equity', 'Code': 'PHAU', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'WisdomTree Physical Gold EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3770', 'Type': 'ETC'}, {'_id': ObjectId('6186a148c2785d1035df286a'), 'AssetType': 'Equity', 'Code': 'EQQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Invesco EQQQ NASDAQ-100 UCITS ETF EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032077012', 'Type': 'ETF'}, {'_id': ObjectId('6186a174c2785d1035dfaf0a'), 'AssetType': 'Equity', 'Code': 'VNRT', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Vanguard FTSE North America UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'USD'}, 'ISIN': 'IE00BKX55R35', 'Type': 'ETF'}, {'_id': ObjectId('6186a183c2785d1035dfd99c'), 'AssetType': 'Equity', 'Code': 'MWRD', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amundi MSCI World UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU1437016972', 'Type': 'ETF'}, {'_id': ObjectId('6186a18cc2785d1035dfef6b'), 'AssetType': 'Equity', 'Code': 'PHAG', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'ETFS Physical Silver ETC EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3333', 'Type': 'ETC'}]} 
Query itx = {'_id': ObjectId('611429d9c889609c9144704c'), 'Code': 'INPHI', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'PHILIPS BUY BACK', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'NL0000009322', 'Type': 'Common Stock', 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a03dc2785d1035dc0997'), 'AssetType': 'Equity', 'Code': '', 'Country': 'France', 'Exchange': 'NYSE', 'General': {'Type': 'Common Stock', 'Name': 'PanAmSat Holding CORP', 'Exchange': 'NYSE', 'CurrencyCode': 'USD', 'LogoURL': ''}, 'ISIN': 'LU1861136247', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a076c2785d1035dcc328'), 'AssetType': 'Fixed Income', 'Code': 'LQDA', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'iShares $ Corp Bond ETF USD Dist', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032895942', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a08cc2785d1035dd047b'), 'AssetType': 'Fixed Income', 'Code': 'BUNS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor Bund Daily Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0530119774', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a097c2785d1035dd2282'), 'AssetType': 'Fixed Income', 'Code': 'UEFR', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'UBS ETF - Markit iBoxx â‚¬ Liquid Corporates UCITS ETF (EUR) A-dis EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0721553864', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a11bc2785d1035deb955'), 'AssetType': 'Equity', 'Code': 'PHAU', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'WisdomTree Physical Gold EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3770', 'Type': 'ETC'}
Query itx = {'_id': ObjectId('6186a148c2785d1035df286a'), 'AssetType': 'Equity', 'Code': 'EQQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Invesco EQQQ NASDAQ-100 UCITS ETF EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032077012', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a174c2785d1035dfaf0a'), 'AssetType': 'Equity', 'Code': 'VNRT', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Vanguard FTSE North America UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'USD'}, 'ISIN': 'IE00BKX55R35', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a183c2785d1035dfd99c'), 'AssetType': 'Equity', 'Code': 'MWRD', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amundi MSCI World UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU1437016972', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a18cc2785d1035dfef6b'), 'AssetType': 'Equity', 'Code': 'PHAG', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'ETFS Physical Silver ETC EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3333', 'Type': 'ETC'}
df  result            ISIN   Code  ... EsgScoreNote total_stocks
0  NL0000009322  INPHI  ...          BBB          560
1  LU1861136247         ...          BBB          560
2  IE0032895942   LQDA  ...          BBB          560
3  LU0530119774   BUNS  ...          BBB          560
4  LU0721553864   UEFR  ...          BBB          560
5  JE00B1VS3770   PHAU  ...          BBB          560
6  IE0032077012   EQQQ  ...          BBB          560
7  IE00BKX55R35   VNRT  ...          BBB          560
8  LU1437016972   MWRD  ...          BBB          560
9  JE00B1VS3333   PHAG  ...          BBB          560

[10 rows x 21 columns] 
127.0.0.1 - - [13/Nov/2021 15:50:28] "[37mGET /api/v1/stock_universe HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 561}], 'data': [{'_id': ObjectId('611429d9c889609c9144704c'), 'Code': 'INPHI', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'PHILIPS BUY BACK', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'NL0000009322', 'Type': 'Common Stock', 'AssetType': 'Equity'}, {'_id': ObjectId('6186a03dc2785d1035dc0997'), 'AssetType': 'Equity', 'Code': '', 'Country': 'France', 'Exchange': 'NYSE', 'General': {'Type': 'Common Stock', 'Name': 'PanAmSat Holding CORP', 'Exchange': 'NYSE', 'CurrencyCode': 'USD', 'LogoURL': ''}, 'ISIN': 'LU1861136247', 'Type': 'ETF'}, {'_id': ObjectId('6186a076c2785d1035dcc328'), 'AssetType': 'Fixed Income', 'Code': 'LQDA', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'iShares $ Corp Bond ETF USD Dist', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032895942', 'Type': 'ETF'}, {'_id': ObjectId('6186a08cc2785d1035dd047b'), 'AssetType': 'Fixed Income', 'Code': 'BUNS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor Bund Daily Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0530119774', 'Type': 'ETF'}, {'_id': ObjectId('6186a097c2785d1035dd2282'), 'AssetType': 'Fixed Income', 'Code': 'UEFR', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'UBS ETF - Markit iBoxx â‚¬ Liquid Corporates UCITS ETF (EUR) A-dis EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0721553864', 'Type': 'ETF'}, {'_id': ObjectId('6186a11bc2785d1035deb955'), 'AssetType': 'Equity', 'Code': 'PHAU', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'WisdomTree Physical Gold EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3770', 'Type': 'ETC'}, {'_id': ObjectId('6186a148c2785d1035df286a'), 'AssetType': 'Equity', 'Code': 'EQQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Invesco EQQQ NASDAQ-100 UCITS ETF EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032077012', 'Type': 'ETF'}, {'_id': ObjectId('6186a174c2785d1035dfaf0a'), 'AssetType': 'Equity', 'Code': 'VNRT', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Vanguard FTSE North America UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'USD'}, 'ISIN': 'IE00BKX55R35', 'Type': 'ETF'}, {'_id': ObjectId('6186a183c2785d1035dfd99c'), 'AssetType': 'Equity', 'Code': 'MWRD', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amundi MSCI World UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU1437016972', 'Type': 'ETF'}, {'_id': ObjectId('6186a18cc2785d1035dfef6b'), 'AssetType': 'Equity', 'Code': 'PHAG', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'ETFS Physical Silver ETC EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3333', 'Type': 'ETC'}]} 
Query itx = {'_id': ObjectId('611429d9c889609c9144704c'), 'Code': 'INPHI', 'Country': 'The Netherlands', 'Exchange': 'AS', 'General': {'Type': 'Common Stock', 'Name': 'PHILIPS BUY BACK', 'Exchange': 'AS', 'CurrencyCode': 'EUR', 'LogoURL': ''}, 'ISIN': 'NL0000009322', 'Type': 'Common Stock', 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6186a03dc2785d1035dc0997'), 'AssetType': 'Equity', 'Code': '', 'Country': 'France', 'Exchange': 'NYSE', 'General': {'Type': 'Common Stock', 'Name': 'PanAmSat Holding CORP', 'Exchange': 'NYSE', 'CurrencyCode': 'USD', 'LogoURL': ''}, 'ISIN': 'LU1861136247', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a076c2785d1035dcc328'), 'AssetType': 'Fixed Income', 'Code': 'LQDA', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'iShares $ Corp Bond ETF USD Dist', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032895942', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a08cc2785d1035dd047b'), 'AssetType': 'Fixed Income', 'Code': 'BUNS', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor Bund Daily Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0530119774', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a097c2785d1035dd2282'), 'AssetType': 'Fixed Income', 'Code': 'UEFR', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'UBS ETF - Markit iBoxx â‚¬ Liquid Corporates UCITS ETF (EUR) A-dis EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU0721553864', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a11bc2785d1035deb955'), 'AssetType': 'Equity', 'Code': 'PHAU', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'WisdomTree Physical Gold EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3770', 'Type': 'ETC'}
Query itx = {'_id': ObjectId('6186a148c2785d1035df286a'), 'AssetType': 'Equity', 'Code': 'EQQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Invesco EQQQ NASDAQ-100 UCITS ETF EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE0032077012', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a174c2785d1035dfaf0a'), 'AssetType': 'Equity', 'Code': 'VNRT', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Vanguard FTSE North America UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'USD'}, 'ISIN': 'IE00BKX55R35', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a183c2785d1035dfd99c'), 'AssetType': 'Equity', 'Code': 'MWRD', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Amundi MSCI World UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'LU1437016972', 'Type': 'ETF'}
Query itx = {'_id': ObjectId('6186a18cc2785d1035dfef6b'), 'AssetType': 'Equity', 'Code': 'PHAG', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'ETFS Physical Silver ETC EUR', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'JE00B1VS3333', 'Type': 'ETC'}
df  result            ISIN   Code  ... EsgScoreNote total_stocks
0  NL0000009322  INPHI  ...          BBB          560
1  LU1861136247         ...          BBB          560
2  IE0032895942   LQDA  ...          BBB          560
3  LU0530119774   BUNS  ...          BBB          560
4  LU0721553864   UEFR  ...          BBB          560
5  JE00B1VS3770   PHAU  ...          BBB          560
6  IE0032077012   EQQQ  ...          BBB          560
7  IE00BKX55R35   VNRT  ...          BBB          560
8  LU1437016972   MWRD  ...          BBB          560
9  JE00B1VS3333   PHAG  ...          BBB          560

[10 rows x 21 columns] 
127.0.0.1 - - [13/Nov/2021 15:52:36] "[37mGET /api/v1/stock_universe HTTP/1.1[0m" 200 -
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA', 'BX4.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'SAN.PA', 'BX4.PA']}}}, {'$sort': {'last_price_volume': 1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 10}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 3}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}, {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('61364fff86ee1aff11e5e2fd'), 'Code': 'SAN', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'Common Stock', 'Name': 'Sanofi', 'Exchange': 'PA', 'CurrencyCode': 'EUR', 'LogoURL': '/img/logos/PA/SAN.png'}, 'ISIN': 'FR0000120578', 'Type': 'Common Stock', 'last_price_volume': 2105657, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114235bc889609c91418aef'), 'Code': 'BX4', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 Daily Double Short UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010411884', 'Type': 'ETF', 'last_price_volume': 11851452, 'AssetType': 'Equity'}
df  result            ISIN Code  ... EsgScoreNote total_stocks
0  FR0007052782  CAC  ...          BBB            2
1  FR0000120578  SAN  ...          BBB            2
2  FR0010411884  BX4  ...          BBB            2

[3 rows x 21 columns] 
127.0.0.1 - - [13/Nov/2021 15:53:18] "[37mGET /api/v1/stock_universe?codes=CAC.PA,SAN.PA,BX4.PA HTTP/1.1[0m" 200 -
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
127.0.0.1 - - [20/Nov/2021 18:19:32] "[37mGET /api/v1/stock_data/CAC.PA HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:19:32] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
127.0.0.1 - - [20/Nov/2021 18:19:37] "[31m[1mGET /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 405 -
127.0.0.1 - - [20/Nov/2021 18:21:03] "[31m[1mGET /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 405 -
127.0.0.1 - - [20/Nov/2021 18:21:09] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 18:21:12] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:21:12] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:21:12] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:21:13] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:21:13] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:24:48] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 18:24:49] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:24:49] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:24:49] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:24:49] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:24:49] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F', 'date': '121F', 'holdings': {'OBLI.PA': 0.0, 'LQQ.PA': 0.0, 'STZ.PA': 0.0, 'CAC.PA': 0.0, 'SAN.PA': 0.0, 'AETH.PA': 0.0, 'ABTC.PA': 0.0}}], 'benchmarkStockCode': 'CAC.PA'}
127.0.0.1 - - [20/Nov/2021 18:25:11] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/stocks.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F', 'date': '121F', 'holdings': {'OBLI.PA': 0.0, 'LQQ.PA': 0.0, 'STZ.PA': 0.0, 'CAC.PA': 0.0, 'SAN.PA': 0.0, 'AETH.PA': 0.0, 'ABTC.PA': 0.0}}], 'benchmarkStockCode': 'CAC.PA'}
127.0.0.1 - - [20/Nov/2021 18:25:52] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F', 'date': '121F', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 18:28:10] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 18:40:39] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 18:41:47] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 18:45:16] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 18:54:29] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 18:54:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:54:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:54:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:54:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:54:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 18:56:54] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 18:56:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:56:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:56:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:56:56] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 18:56:56] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:00:08] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 19:00:09] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:00:09] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:00:09] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:00:10] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:00:10] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:04:36] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:14:32] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 19:14:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:14:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:14:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:14:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:14:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:16:33] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 19:16:33] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:16:33] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:16:33] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:16:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:16:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:16:50] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 19:16:51] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:16:51] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:16:51] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:16:52] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:16:52] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:17:25] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 19:17:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:17:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:17:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:17:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:17:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:18:38] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 19:18:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:18:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:18:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:18:40] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:18:40] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:19:03] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:21:24] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
127.0.0.1 - - [20/Nov/2021 19:21:56] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  FR0013346681  OBLI  ...          BBB            3
2  IE00BKWQ0G16   STZ  ...          BBB            3
3  FR0010342592   LQQ  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  FR0013346681  OBLI  ...          BBB            3
2  IE00BKWQ0G16   STZ  ...          BBB            3
3  FR0010342592   LQQ  ...          BBB            3

[4 rows x 21 columns]
127.0.0.1 - - [20/Nov/2021 19:25:32] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  FR0013346681  OBLI  ...          BBB            3
2  IE00BKWQ0G16   STZ  ...          BBB            3
3  FR0010342592   LQQ  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  FR0013346681  OBLI  ...          BBB            3
2  IE00BKWQ0G16   STZ  ...          BBB            3
3  FR0010342592   LQQ  ...          BBB            3

[4 rows x 21 columns]
127.0.0.1 - - [20/Nov/2021 19:27:58] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 19:27:59] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:27:59] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:27:59] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:28:00] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 19:28:00] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  FR0013346681  OBLI  ...          BBB            3
2  IE00BKWQ0G16   STZ  ...          BBB            3
3  FR0010342592   LQQ  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  FR0013346681  OBLI  ...          BBB            3
2  IE00BKWQ0G16   STZ  ...          BBB            3
3  FR0010342592   LQQ  ...          BBB            3

[4 rows x 21 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned Empty DataFrame
Columns: []
Index: []
127.0.0.1 - - [20/Nov/2021 19:28:17] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 51384, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 7656, 'AssetType': 'Fixed Income'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 5383, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 3878, 'AssetType': 'Equity'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  FR0013346681  OBLI  ...          BBB            3
2  IE00BKWQ0G16   STZ  ...          BBB            3
3  FR0010342592   LQQ  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  FR0013346681  OBLI  ...          BBB            3
2  IE00BKWQ0G16   STZ  ...          BBB            3
3  FR0010342592   LQQ  ...          BBB            3

[4 rows x 21 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned Empty DataFrame
Columns: []
Index: []
df_h_p =Empty DataFrame
Columns: []
Index: []
127.0.0.1 - - [20/Nov/2021 19:28:41] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [20/Nov/2021 19:32:33] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [20/Nov/2021 22:36:29] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [20/Nov/2021 22:37:21] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 22:37:22] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:37:22] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:37:22] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:37:23] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:37:24] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'CAC.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'CAC.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'CAC.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [20/Nov/2021 22:39:01] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 22:39:01] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:39:01] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:39:01] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:39:02] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:39:03] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [20/Nov/2021 22:39:42] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 22:39:43] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:39:43] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:39:43] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:39:44] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:39:44] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [20/Nov/2021 22:43:07] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 22:43:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:43:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:43:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:43:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:43:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [20/Nov/2021 22:44:37] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [20/Nov/2021 22:44:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:44:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:44:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:44:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [20/Nov/2021 22:44:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:36:49] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:36:50] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:36:50] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:36:50] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:36:51] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:36:51] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:43:37] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:43:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:43:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:43:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:43:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:43:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:44:18] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:44:19] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:44:19] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:44:19] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:44:20] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:44:20] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:47:35] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:47:36] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:47:36] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:47:36] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:47:37] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:47:37] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:48:31] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:48:32] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:48:32] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:48:32] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:48:33] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:48:33] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:49:38] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:49:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:49:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:49:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:49:40] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:49:40] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:51:04] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:51:05] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:51:05] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:51:05] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:51:06] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:51:06] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:52:51] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:52:52] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:52:52] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:52:52] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:52:53] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:52:53] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:53:50] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:53:51] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:53:51] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:53:51] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:53:52] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:53:52] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:54:26] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:54:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:54:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:54:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:54:28] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:54:28] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:56:54] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:56:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:56:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:56:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:56:56] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:56:56] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 06:57:23] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 06:57:24] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:57:24] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:57:24] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:57:24] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 06:57:25] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:00:40] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.4, 'CAC.PA': 0.4}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.3, 'LQQ.PA': 0.2, 'STZ.PA': 0.3, 'CAC.PA': 0.2}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 0.1, 'LQQ.PA': 0.1, 'STZ.PA': 0.1, 'CAC.PA': 0.7}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:01:37] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 5, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:03:06] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 5, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:05:21] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 5, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:07:03] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 5, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:08:27] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 5, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:15:57] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 5, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:21:35] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 5, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'STZ.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:28:12] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 07:28:13] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 07:28:13] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 07:28:13] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 07:28:14] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 07:28:14] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 5, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:29:18] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 07:29:19] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 07:29:19] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 07:29:19] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 07:29:20] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 07:29:20] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 5, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 4, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:29:58] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 2, 'LQQ.PA': 1, 'STZ.PA': 5, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:30:45] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:31:02] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:57:12] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 07:59:53] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 08:06:12] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 08:06:14] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:06:14] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:06:14] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:06:15] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:06:15] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 08:08:01] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 08:08:02] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:08:02] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:08:02] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:08:03] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:08:03] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 08:10:01] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 08:10:01] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:10:01] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:10:01] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:10:02] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:10:02] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'CAC.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'CAC.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'CAC.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 08:21:26] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 08:21:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:21:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:21:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:21:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:21:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 08:23:33] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 08:23:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:23:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:23:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:23:34] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 08:23:35] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 12:46:37] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 12:46:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 12:46:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 12:46:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 12:46:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 12:46:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 12:49:29] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 12:49:52] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 12:51:17] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 12:52:37] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 12:52:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 12:52:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 12:52:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 12:52:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 12:52:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 12:54:54] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:00:36] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:04:14] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:04:16] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:04:16] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:04:16] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:04:16] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:04:17] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:05:02] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:05:03] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:03] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:03] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:04] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:04] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:05:25] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:05:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:05:38] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:05:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:05:39] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:06:07] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:11:54] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:11:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:11:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:11:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:11:56] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:11:56] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:12:24] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:25:57] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:25:58] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:25:58] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:25:58] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:25:59] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:25:59] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:26:30] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:26:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:26:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:26:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:26:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:26:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:27:35] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:28:24] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:28:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:28:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:28:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:28:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:28:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:29:24] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:29:25] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:29:25] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:29:25] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:29:25] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:29:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:53:30] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 13:53:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:53:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:53:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:53:32] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 13:53:32] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 13:56:01] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'CAC'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA', 'CAC']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 14:04:52] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
df_h_p =          date     open     high  ...  volume     code  converted_date
0   2021-11-16   70.450   70.550  ...   27998   CAC.PA    1.637017e+09
1   2021-11-17   70.480   70.600  ...   21757   CAC.PA    1.637104e+09
2   2021-11-18   70.460   70.730  ...   24410   CAC.PA    1.637190e+09
3   2021-11-19   70.660   70.710  ...   43776   CAC.PA    1.637276e+09
4   2021-11-16  927.900  942.500  ...    3594   LQQ.PA    1.637017e+09
5   2021-11-17  946.100  952.100  ...    3439   LQQ.PA    1.637104e+09
6   2021-11-18  951.700  956.900  ...    2905   LQQ.PA    1.637190e+09
7   2021-11-19  972.200  981.000  ...    5866   LQQ.PA    1.637276e+09
8   2021-11-16   11.000   11.000  ...    1226  OBLI.PA    1.637017e+09
9   2021-11-17   10.900   10.900  ...    3088  OBLI.PA    1.637104e+09
10  2021-11-18   10.916   10.916  ...     733  OBLI.PA    1.637190e+09
11  2021-11-19   10.910   10.964  ...    4281  OBLI.PA    1.637276e+09
12  2021-11-16   63.400   63.400  ...    3694   STZ.PA    1.637017e+09
13  2021-11-17   63.310   63.460  ...    5832   STZ.PA    1.637104e+09
14  2021-11-18   63.100   63.330  ...    6674   STZ.PA    1.637190e+09
15  2021-11-19   62.820   62.900  ...   18663   STZ.PA    1.637276e+09

[16 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 14:06:21] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'LQQ.PA', 'CAC.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 15:57:29] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'CAC.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'CAC.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'CAC.PA', 'STZ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 16:12:48] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 16:12:50] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:12:50] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:12:50] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:12:50] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:12:51] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'LQQ.PA', 'STZ.PA', 'CAC.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 16:14:40] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 16:14:41] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:14:41] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:14:41] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:14:42] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:14:42] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'STZ.PA', 'OBLI.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
127.0.0.1 - - [21/Nov/2021 16:16:43] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 16:16:43] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:16:43] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:16:43] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:16:44] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:16:44] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'CAC.PA', 'OBLI.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 16:21:13] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 16:21:14] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:21:14] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:21:14] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:21:15] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:21:15] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
daily_returns =               value        date
date                            
2021-11-16       NaN  2021-11-16
2021-11-17  0.491630  2021-11-17
2021-11-18  0.321120  2021-11-18
2021-11-19 -0.400094  2021-11-19, b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 16:32:53] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 16:32:54] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:32:54] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:32:54] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:32:54] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:32:54] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'CAC.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'CAC.PA', 'LQQ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 16:35:29] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 16:35:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:35:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:35:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:35:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:35:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'OBLI.PA', 'LQQ.PA', 'CAC.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value        date
date                            
2021-11-17  0.491630  2021-11-17
2021-11-18  0.321120  2021-11-18
2021-11-19 -0.400094  2021-11-19, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 16:36:46] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 16:36:47] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:36:47] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:36:47] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:36:47] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 16:36:47] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-16  2009.950
2021-11-17  2998.102
2021-11-18  3960.854
2021-11-19  2376.140, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 16:43:52] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-16  2009.950
2021-11-17  2998.102
2021-11-18  3960.854
2021-11-19  2376.140, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
greeks =beta                                          0
alpha    close   NaN
value   NaN
dtype: float64
dtype: object
127.0.0.1 - - [21/Nov/2021 16:45:46] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'LQQ.PA', 'STZ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-16  2009.950
2021-11-17  2998.102
2021-11-18  3960.854
2021-11-19  2376.140, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
alpha close   NaN
value   NaN
dtype: float64, beta nan
127.0.0.1 - - [21/Nov/2021 16:50:06] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'OBLI.PA', 'STZ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-16  2009.950
2021-11-17  2998.102
2021-11-18  3960.854
2021-11-19  2376.140, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:00:23] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:00:24] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:00:24] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:00:24] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:00:25] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:00:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-16  2009.950
2021-11-17  2998.102
2021-11-18  3960.854
2021-11-19  2376.140, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:02:37] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:02:37] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:02:37] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:02:37] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:02:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:02:38] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'OBLI.PA', 'LQQ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-16  2009.950
2021-11-17  2998.102
2021-11-18  3960.854
2021-11-19  2376.140, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:02:56] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:02:57] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:02:57] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:02:57] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:02:57] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:02:57] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-16  2009.950
2021-11-17  2998.102
2021-11-18  3960.854
2021-11-19  2376.140, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:06:04] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:06:05] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:06:05] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:06:05] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:06:06] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:06:06] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value        date
date                            
2021-11-16       NaN  2021-11-16
2021-11-17  0.491630  2021-11-17
2021-11-18  0.321120  2021-11-18
2021-11-19 -0.400094  2021-11-19, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:15:54] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:15:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:15:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:15:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:15:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:15:55] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'LQQ.PA', 'CAC.PA', 'OBLI.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-16       NaN
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:17:03] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:17:03] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:17:03] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:17:03] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:17:04] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:17:04] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'STZ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'STZ.PA', 'CAC.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:18:07] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:18:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:18:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:18:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:18:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:18:08] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['STZ.PA', 'CAC.PA', 'OBLI.PA', 'LQQ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:19:05] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:19:06] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:19:06] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:19:06] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:19:06] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:19:07] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'LQQ.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'STZ.PA', 'LQQ.PA', 'CAC.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:20:30] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:20:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:20:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:20:30] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:20:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:20:31] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'STZ.PA', 'OBLI.PA', 'CAC.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
127.0.0.1 - - [21/Nov/2021 17:24:24] "[35m[1mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 500 -
127.0.0.1 - - [21/Nov/2021 17:24:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:24:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=jquery.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:24:26] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:24:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=ubuntu.ttf HTTP/1.1[0m" 200 -
127.0.0.1 - - [21/Nov/2021 17:24:27] "[37mGET /api/v1/compute_portfolio_analytics?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'OBLI.PA', 'STZ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
result None
127.0.0.1 - - [21/Nov/2021 17:26:27] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Running on http://0.0.0.0:5005/ (Press CTRL+C to quit)
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
result None
127.0.0.1 - - [21/Nov/2021 17:27:48] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'OBLI.PA', 'LQQ.PA', 'STZ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
result None
127.0.0.1 - - [21/Nov/2021 17:30:00] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'STZ.PA', 'LQQ.PA', 'OBLI.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
result None
127.0.0.1 - - [21/Nov/2021 17:31:18] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['CAC.PA', 'LQQ.PA', 'STZ.PA', 'OBLI.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
result None
127.0.0.1 - - [21/Nov/2021 17:32:07] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['OBLI.PA', 'CAC.PA', 'STZ.PA', 'LQQ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
result None
127.0.0.1 - - [21/Nov/2021 17:37:27] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/asset_prices/prices.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'CAC.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'CAC.PA', 'STZ.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'OBLI.PA', 'CAC.PA', 'STZ.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Data returned           date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_h_p =          date      open      high  ...     volume       code  converted_date
0   2021-11-16    70.450    70.550  ...      27998     CAC.PA    1.637017e+09
1   2021-11-17    70.480    70.600  ...      21757     CAC.PA    1.637104e+09
2   2021-11-18    70.460    70.730  ...      24410     CAC.PA    1.637190e+09
3   2021-11-19    70.660    70.710  ...      43776     CAC.PA    1.637276e+09
4   2021-11-16  7146.370  7164.270  ...   69021696  FCHI.INDX    1.637017e+09
5   2021-11-17  7149.300  7167.800  ...   68243504  FCHI.INDX    1.637104e+09
6   2021-11-18  7155.050  7181.550  ...   75845600  FCHI.INDX    1.637190e+09
7   2021-11-19  7172.720  7183.080  ...  117988000  FCHI.INDX    1.637276e+09
8   2021-11-16   927.900   942.500  ...       3594     LQQ.PA    1.637017e+09
9   2021-11-17   946.100   952.100  ...       3439     LQQ.PA    1.637104e+09
10  2021-11-18   951.700   956.900  ...       2905     LQQ.PA    1.637190e+09
11  2021-11-19   972.200   981.000  ...       5866     LQQ.PA    1.637276e+09
12  2021-11-16    11.000    11.000  ...       1226    OBLI.PA    1.637017e+09
13  2021-11-17    10.900    10.900  ...       3088    OBLI.PA    1.637104e+09
14  2021-11-18    10.916    10.916  ...        733    OBLI.PA    1.637190e+09
15  2021-11-19    10.910    10.964  ...       4281    OBLI.PA    1.637276e+09
16  2021-11-16    63.400    63.400  ...       3694     STZ.PA    1.637017e+09
17  2021-11-17    63.310    63.460  ...       5832     STZ.PA    1.637104e+09
18  2021-11-18    63.100    63.330  ...       6674     STZ.PA    1.637190e+09
19  2021-11-19    62.820    62.900  ...      18663     STZ.PA    1.637276e+09

[20 rows x 9 columns]
df_bhp =         date     open     high  ...     volume       code  converted_date
4  2021-11-16  7146.37  7164.27  ...   69021696  FCHI.INDX    1.637017e+09
5  2021-11-17  7149.30  7167.80  ...   68243504  FCHI.INDX    1.637104e+09
6  2021-11-18  7155.05  7181.55  ...   75845600  FCHI.INDX    1.637190e+09
7  2021-11-19  7172.72  7183.08  ...  117988000  FCHI.INDX    1.637276e+09

[4 rows x 9 columns]
b_daily_returns =               close
date                
2021-11-16       NaN
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
g_daily_returns =               value
date                
2021-11-17  0.491630
2021-11-18  0.321120
2021-11-19 -0.400094, g_b_daily_returns =               close
date                
2021-11-17  0.000594
2021-11-18 -0.002078
2021-11-19 -0.004157
result beta 0.004605872897015799, alpha -0.0025137648720715295
127.0.0.1 - - [21/Nov/2021 17:39:10] "[37mPOST /api/v1/compute_portfolio_analytics HTTP/1.1[0m" 200 -
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
 * Detected change in '/Users/sergengoube/PycharmProjects/investingclub/api/utils.py', reloading
 * Restarting with fsevents reloader
Unknown option passed to Flask-CORS: support_credentials
Unknown option passed to Flask-CORS: support_credentials
 * Debugger is active!
 * Debugger PIN: 139-003-692
params ={'portfolioId': 'max_diversification', 'portfolioHistoricalHoldings': [{'id': '121F4343564ACD', 'date': '2021-11-19T19:40:06+00:00', 'holdings': {'OBLI.PA': 20, 'LQQ.PA': 1, 'STZ.PA': 10, 'CAC.PA': 8}}, {'id': '121F4343564ACD', 'date': '2021-11-18T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 3, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-17T19:40:06+00:00', 'holdings': {'OBLI.PA': 1, 'LQQ.PA': 2, 'STZ.PA': 6, 'CAC.PA': 10}}, {'id': '121F4343564ACD', 'date': '2021-11-16T19:40:06+00:00', 'holdings': {'OBLI.PA': 5, 'LQQ.PA': 1, 'STZ.PA': 6, 'CAC.PA': 9}}], 'benchmarkStockCode': 'FCHI.INDX'}
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query get_universe [{'$match': {'Active': 1, 'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'STZ.PA', 'OBLI.PA']}}}, {'$sort': {'last_price_volume': -1}}, {'$facet': {'metadata': [{'$count': 'total'}], 'data': [{'$skip': 0}, {'$limit': 5000}, {'$project': {'ISIN': 1, 'Code': 1, 'General.Name': 1, 'Country': 1, 'Type': 1, 'General.Exchange': 1, 'General.CurrencyCode': 1, 'General.Type': 1, 'Exchange': 1, 'AssetType': 1, 'last_price_volume': 1, 'General.LogoURL': 1}}]}}] 
Query result {'metadata': [{'total': 4}], 'data': [{'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}, {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}, {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}]} 
Query itx = {'_id': ObjectId('611424a7c889609c914222f7'), 'Code': 'CAC', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Lyxor CAC 40 (DR) UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0007052782', 'Type': 'ETF', 'last_price_volume': 43776, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249fc889609c91421fff'), 'Code': 'STZ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'SSgA SPDR ETFs Europe II Public Limited Company - SPDR MSCI Europe Financials UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'IE00BKWQ0G16', 'Type': 'ETF', 'last_price_volume': 18663, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('6114249dc889609c91421f30'), 'Code': 'LQQ', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': 'Multi Units France - Lyxor PEA Nasdaq 100 Daily (2X) leveraged UCITS ETF', 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0010342592', 'Type': 'ETF', 'last_price_volume': 5866, 'AssetType': 'Equity'}
Query itx = {'_id': ObjectId('60dead3b094f5da1d4664350'), 'Code': 'OBLI', 'Country': 'France', 'Exchange': 'PA', 'General': {'Type': 'ETF', 'Name': "Lyxor Index Fund - Lyxor PEA Obligations d'Etat Euro UCITS ETF", 'Exchange': 'PA', 'CurrencyCode': 'EUR'}, 'ISIN': 'FR0013346681', 'Type': 'ETF', 'last_price_volume': 4281, 'AssetType': 'Fixed Income'}
NumExpr defaulting to 8 threads.
df  result            ISIN  Code  ... EsgScoreNote total_stocks
0  FR0007052782   CAC  ...          BBB            3
1  IE00BKWQ0G16   STZ  ...          BBB            3
2  FR0010342592   LQQ  ...          BBB            3
3  FR0013346681  OBLI  ...          BBB            3

[4 rows x 21 columns] 
stock_data_df =           ISIN  Code  ... total_stocks     code
0  FR0007052782   CAC  ...            3   CAC.PA
1  IE00BKWQ0G16   STZ  ...            3   STZ.PA
2  FR0010342592   LQQ  ...            3   LQQ.PA
3  FR0013346681  OBLI  ...            3  OBLI.PA

[4 rows x 22 columns]
dates sent from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
dates Computed from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
Done get_prices: historical, query : [{'$match': {'FullCode': {'$in': ['LQQ.PA', 'CAC.PA', 'STZ.PA', 'OBLI.PA', 'FCHI.INDX']}}}, {'$project': {'prices': {'$filter': {'input': '$prices', 'as': 'price', 'cond': {'$and': [{'$gte': ['$$price.converted_date', 1637017200.0]}, {'$lte': ['$$price.converted_date', 1637276400.0]}]}}}}}]: dates from 2021-11-16 00:00:00 to 2021-11-19 00:00:00
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
 * Restarting with fsevents reloader
